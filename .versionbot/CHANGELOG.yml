- commits:
    - subject: ensure "force-finalize" guarantees a finalized release
      hash: 08e6722b16af9c6e339fd1862b28d641fdcc5035
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: update example workflow to use "deploy-environment" input
      hash: 044e2122041ba0d7d4a18c2d0cd653b512c42130
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: remove "deploy-esr" input
      hash: 2ea4e3b60c88da21427cf525ed7fed4ab32de6f5
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: remove "deploy-s3" input
      hash: dee1de47e43055e8ef8dd3dc17c8e614e89e835e
      body: |
        Instead, always deploy to s3 if we "deploy" anything
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: remove "deploy-hostapp" and add "force-finalize" and
        "finalize-on-push-if-tests-passed"
      hash: d1de37252ca8d1d1e41d6253abdac602d9999f1d
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: rename "envinroment" input to "deploy-environment" for clarity
      hash: 14e6a1e57faf63f98970254902fd82deb49e586d
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: remove os-dev input
      hash: 8f5bd516abe24758ee129cb835d3b021bb5c3284
      body: >
        Removing denabling of development features as we determined it would
        rarely be used - dev images can just be built locally instead
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
  version: 1.25.24
  title: ""
  date: 2024-08-21T16:22:42.006Z
- commits:
    - subject: Add mermaid flowchart to yocto workflow README
      hash: af6f93c1a415ecf90785428c32b31801b26ad160
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.25.23
  title: ""
  date: 2024-08-15T20:45:12.698Z
- commits:
    - subject: Update Lock file maintenance
      hash: 156711aceb7e2be7048ea668800ff9368bf35df8
      body: |
        Update 
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.22
  title: ""
  date: 2024-08-12T01:57:02.017Z
- commits:
    - subject: Update balena-os/leviathan digest to f4e9332
      hash: 6a7097208111936aac9a8862c61d6f600d1652dd
      body: |
        Update balena-os/leviathan
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.21
  title: ""
  date: 2024-08-06T18:50:02.588Z
- commits:
    - subject: Update actions/upload-artifact action to v4.3.6
      hash: 03b4f76a25f7c887c3c1cbae6293bce772773f6d
      body: |
        Update actions/upload-artifact from 4.3.5 to 4.3.6
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.20
  title: ""
  date: 2024-08-06T16:39:55.294Z
- commits:
    - subject: Update balena-os/leviathan digest to a16cf0f
      hash: f0d8fdd6add9aa34a89234491e6a82ac7583b48e
      body: |
        Update balena-os/leviathan
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.19
  title: ""
  date: 2024-08-06T12:46:47.450Z
- commits:
    - subject: Update actions/upload-artifact action to v4.3.5
      hash: 47535180af9f0a0dcb35ba6b0edea204e7de3ba7
      body: |
        Update actions/upload-artifact from 4.3.4 to 4.3.5
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.18
  title: ""
  date: 2024-08-05T04:31:00.525Z
- commits:
    - subject: Update Lock file maintenance
      hash: bb1923b984c6646d36356f4acf171a30cabdfd3d
      body: |
        Update 
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.17
  title: ""
  date: 2024-08-05T02:04:43.860Z
- commits:
    - subject: Update docker/login-action action to v3.3.0
      hash: 65a653d66efd1cbfdca1616d62a9387dc47eb50e
      body: |
        Update docker/login-action from 3.0.0 to 3.3.0
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.16
  title: ""
  date: 2024-07-30T03:01:08.144Z
- commits:
    - subject: Update actions/upload-artifact action to v4.3.4
      hash: f81cf0f07965cf34d687b76e9ad7befc6f49cf9c
      body: |
        Update actions/upload-artifact from 4.3.0 to 4.3.4
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.15
  title: ""
  date: 2024-07-30T01:00:25.663Z
- commits:
    - subject: Update balena-os/leviathan digest to 36aafe0
      hash: e5842524bf70adc29c62f35e0744ee970d232866
      body: |
        Update balena-os/leviathan
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.14
  title: ""
  date: 2024-07-29T22:37:24.756Z
- commits:
    - subject: Update actions/checkout action to v4.1.7
      hash: c9da5d524bbebe7dde5175584589cce5634b7a41
      body: |
        Update actions/checkout from 4.1.1 to 4.1.7
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.13
  title: ""
  date: 2024-07-29T20:55:15.720Z
- commits:
    - subject: Update Pin dependencies
      hash: c48f1f984f2f22f49fc9aee3f1cc9883f8ca7ec5
      body: |
        Update actions/checkout
      footer:
        Change-type: patch
        change-type: patch
      author: balena-renovate[bot]
      nested: []
  version: 1.25.12
  title: ""
  date: 2024-07-29T18:13:01.088Z
- commits:
    - subject: "revovate: change config to use balena-io template"
      hash: f4d82d9029f39245cf15d2433a783d33787a73d1
      body: >
        in this repo we are using "change-type" commits, but renovate is using
        the balena-os default which is using "changelog-entry"
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
  version: 1.25.11
  title: ""
  date: 2024-07-29T15:14:59.755Z
- commits:
    - subject: By default, deploy hostapp on push only
      hash: 87763dfc75504522c1dadc698f74576bbf0e9320
      body: |
        This is meant to keep the defaults of `deploy-s3` and `deploy-hostapp`
        consistent.
      footer:
        Signed-off-by: Leandro Motta Barros <leandro@balena.io>
        signed-off-by: Leandro Motta Barros <leandro@balena.io>
        Change-type: patch
        change-type: patch
      author: Leandro Motta Barros
      nested: []
  version: 1.25.10
  title: ""
  date: 2024-07-23T02:23:14.094Z
- commits:
    - subject: use token to fetch private contracts
      hash: acfc8d20ce8dd4b29eae67679dd1a89ffcc75c7c
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: unroll balena_lib_build_contract function
      hash: 82c9e482f3bfb0fcd960c455f2c8ff0c42c98baa
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: unroll balena_api_is_dt_private function
      hash: cc3102dbb1348ee563b08dfd3afd37daaa0404ca
      body: >
        when building + deploying or a private DT , the check to see if the DT
        is private fails. This is due to
        https://github.com/balena-os/balena-yocto-scripts/blob/master/automation/include/balena-api.inc#L424
        using this function:
        https://github.com/balena-os/balena-yocto-scripts/blob/master/automation/include/balena-lib.inc#L191
        - which uses the jenkins deployTo variable to select the correct api url
        and token.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
  version: 1.25.9
  title: ""
  date: 2024-07-22T16:18:49.689Z
- commits:
    - subject: Use env vars BALENA_HOST and BALENACLOUD_SSH_URL when provided
      hash: f04607fc0f50a99bb2fd14370a2e2dae0e3f7094
      body: |
        These currently differ between environments, and we will need
        to start supporting environment names that are not the same
        as the balena host.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.25.8
  title: ""
  date: 2024-07-17T19:56:20.231Z
- commits:
    - subject: Fix handling of empty test matrix input
      hash: 727d8d275455361d3bc82b5aec392e9aaa08248b
      body: |
        Previously an empty test matrix would cause
        an error in the workflow.

        Added an if condition to check for a valid
        test_suite property where applicable.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.25.7
  title: ""
  date: 2024-07-16T20:10:01.990Z
- commits:
    - subject: Use App Installation tokens so we can clone private submodules
      hash: 9ca32e51938efc3c5cd01b96eecce85665fb9698
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.25.6
  title: ""
  date: 2024-07-15T15:11:37.708Z
- commits:
    - subject: only login to s3 if deploying to s3
      hash: a23ed7074fd2af18b952b9d0f6ee2623dd6a76f8
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
  version: 1.25.5
  title: ""
  date: 2024-07-08T16:52:21.474Z
- commits:
    - subject: "balena-deploy: deploy secure boot lock artifacts if available"
      hash: 01378a49b0b2264afcf6d2dc4d016e2be206fde7
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.25.4
  title: ""
  date: 2024-07-06T09:01:53.726Z
- commits:
    - subject: use workflow run of PR head instead of statuses to determine test results
      hash: ad06820f4174568383678710fa68b2054da6db57
      body: >
        Since we have moved to workflows for tests instead of status checks, we
        have to fetch the workflow runs for the appropriate commit to determine
        a test pass/fail.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
  version: 1.25.3
  title: ""
  date: 2024-07-05T12:42:09.570Z
- commits:
    - subject: Remove dry-run flag from S3 upload
      hash: cf0301996022ef58a9c19d40d002d72a1bbcf705
      body: |
        We are publishing hostapp releases to staging already, we should
        start including the associated S3 files as well.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.25.2
  title: ""
  date: 2024-07-03T21:19:20.964Z
- commits:
    - subject: Fix actionlint errors and warnings in shell steps
      hash: da910ed9ac6fdd70bd0ebd1beb0dbbd1248517fd
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.25.1
  title: ""
  date: 2024-07-03T18:33:05.802Z
- commits:
    - subject: Do not run any tests by default unless provided by calling workflow
      hash: d0cfc42cf8a17ef6b5f2ac4eed6f84d1581435e6
      body: |
        As there are currently more device types without tests than with,
        and some of those with tests need to provide overrides anyway, it's
        simpler to assume an empty test matrix unless provided.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.25.0
  title: ""
  date: 2024-07-03T15:44:25.729Z
- commits:
    - subject: "patch: No upload to GH artifacts when PR is closed"
      hash: cdee530e227972e251a2c7c06f4a3e97747419ca
      body: |
        Uploading artifacts to GH artifact storage when PR is merged
        (closed event) is wasterful. Since they are only uploaded for temporary
        basis so it can be used for testing. Hence, the PR to stop doing that
        for closed PR event
      footer:
        Signed-off-by: Vipul Gupta (@vipulgupta2048) <vipulgupta2048@gmail.com>
        signed-off-by: Vipul Gupta (@vipulgupta2048) <vipulgupta2048@gmail.com>
      author: Vipul Gupta (@vipulgupta2048)
      nested: []
  version: 1.24.3
  title: ""
  date: 2024-07-02T22:05:09.072Z
- commits:
    - subject: Fix quoting of $GITHUB_OUTPUT
      hash: 5f56f3236d8ee3d764e46e419aa2431dd42d45ff
      body: |
        We had typos in two cases, in which we missed the opening quote.
      footer:
        Signed-off-by: Leandro Motta Barros <leandro@balena.io>
        signed-off-by: Leandro Motta Barros <leandro@balena.io>
        Change-type: patch
        change-type: patch
      author: Leandro Motta Barros
      nested: []
  version: 1.24.2
  title: ""
  date: 2024-07-02T00:54:39.074Z
- commits:
    - subject: Simplify check for secure boot
      hash: be189f7e2f6fb26f778f29e1f955a1cdd01bc8a4
      body: |
        We were previously introducing a variable that was essentially
        replicating the contents of an input. This commit makes use of the input
        directly.

        Incidentally, the previous code also had a small bug/typo, in which we
        mixed a test for string length with a test for string equality.
      footer:
        Signed-off-by: Leandro Motta Barros <leandro@balena.io>
        signed-off-by: Leandro Motta Barros <leandro@balena.io>
        Change-type: patch
        change-type: patch
      author: Leandro Motta Barros
      nested: []
  version: 1.24.1
  title: ""
  date: 2024-06-27T20:35:29.474Z
- commits:
    - subject: Support runner selection in the test matrix
      hash: d409cb0fbaa307a179973b60e5faff8cda6bc34b
      body: >
        Default to self-hosted X64 with KVM for now to align with Jenkins but in
        the future

        we should consider using GitHub hosted runners for the testbot workers.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
    - subject: Allow both combinatorial and include syntax for test_matrix
      hash: 2bfc3a0d72830626366cf210f4fe9a0e649688c5
      body: |
        The include syntax allows full control over settings used
        in each test job, but the combinatorial is simpler to write
        for basic use cases.

        Rather than force one, we can allow both and default to the simple
        syntax.

        Marking as minor since the input syntax has changed, but isn't
        currently used in production anywhere.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.24.0
  title: ""
  date: 2024-06-26T21:26:13.711Z
- commits:
    - subject: Refactor secrets and variables to use environments
      hash: c46eb9cfa4a272f00af4029c31e355477169802a
      body: |
        Reduce the required secrets and inputs required by
        relying on vars and secrets set in each GitHub Environment.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.23.1
  title: ""
  date: 2024-06-26T12:43:22.833Z
- commits:
    - subject: "Dockerfiles: update balenaCLI version to 18.2.2"
      hash: cd6ff2606e5f7a251c6b03d4cfbea371d00a9db7
      body: |
        Update balena CLI from 17.2.2 to 18.2.2.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
    - subject: "Dockerfile_yocto-build-env: bump base image to 22.04"
      hash: e027c512dbcf801a66a4bb4da15639ca67eedd2e
      body: |
        This brings a new Docker engine version which supports cgroup v2.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.23.0
  title: ""
  date: 2024-06-19T15:20:58.274Z
- commits:
    - subject: Update job conditions to allow non-PR events for internal branches
      hash: 2d0f1029d7b5489feb7c98d749ff66c8faf2f1e7
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
    - subject: Hardcode environment paths at the job level
      hash: 5dc710c0cc5d8a1c0da97bbb9d39fdb51f5a4497
      body: |
        This is easier to read and less likely to break
        with unexpected values.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
    - subject: Replace test inputs with a single JSON matrix input
      hash: 0d6cb8ac05fec8dd314f12e5335f847ef3f8ab78
      body: |
        This allows full control over which test conditions are
        used for each test job without combinatorial explosion.

        For example, different environments could be used for
        specific test suites, or the cloud suite could be run
        twice while the other suites run once.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.22.4
  title: ""
  date: 2024-06-14T15:57:11.418Z
- commits:
    - subject: "jenkins_generate_ami: pass yocto scripts version as an env var to
        helper container"
      hash: af71169b93e855c8ecb378b5de3d4a1c12f44510
      body: >
        The ami deploys in jenkins fail at the moment because the balena-lib.inc
        script fails to fetch the version of the yocto scripts when running
        inside the helper image. Passing the version to the helper image via an
        env var helps this
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
  version: 1.22.3
  title: ""
  date: 2024-06-13T19:04:31.350Z
- commits:
    - subject: Update the triggers on the example test workflow
      hash: 1f09e509e09a1a44b62772b9e197fe183c72744d
      body: |
        We do not need to run the workflow on close/merge, and we
        can skip the manual workflow runs on this project as
        each device type will have it's own workflow in the device
        repos supporting manual triggers.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.22.2
  title: ""
  date: 2024-06-12T17:54:57.718Z
- commits:
    - subject: Prevent duplicate workflow runs for multiple triggers
      hash: e0132cfba86fcc05527dc4702d6841723752be38
      body: |
        This may need to be force merged.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
    - subject: Add catchall job to yocto-build-deploy for merge requirements
      hash: 6b023b572a35d18743cf4a5d36b9d2f7443fc744
      body: |
        This is a helper job to avoid having to mark all build/test
        matrices as required, as this job will always run and return
        success or failure.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.22.1
  title: ""
  date: 2024-06-07T13:45:18.699Z
- commits:
    - subject: Create workflow to build and deploy balenaOS
      hash: 5868caaa3b7bf506381c8d22f7b0b4035f7e2658
      body: ""
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.22.0
  title: ""
  date: 2024-06-06T17:24:03.676Z
- commits:
    - subject: "balena-deploy: deploy usbboot if available"
      hash: a62a90bcf05fdccc9cdbaa9961d2db823bbeb9b5
      body: |
        This is where the RPI family deploys provisioning artifacts.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.21.10
  title: ""
  date: 2024-05-02T09:18:16.451Z
- commits:
    - subject: "balena-lib: improve base tag detection"
      hash: 872bb3b1df920b026b524e041bf4f4f7c422cb2f
      body: |
        When a ESR release is deployed a tag with the base meta-balena version
        is created. This is used by the API to check for a valid OS version
        for updates.

        The current mechanism to find the base version only provides an ESR
        version for the first commit after the branch has been created.

        Using merge-base to find the common ancestor and `tag --points-at` to
        find the actual tag works for all commits after the branch is created.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.21.9
  title: ""
  date: 2024-04-30T14:17:29.958Z
- commits:
    - subject: Support commit tags when extracting version tag from git
      hash: 98fec51fae4721224e64cfec52480a5f17b8e271
      body: >
        Git describe does not include commit tags by default, and only annotated
        tags are shown.


        This behaviour was fine until a recent CI issue changed the types of
        tags used to version the repositories.


        This commit allows supporting of both types while the CI issue is
        investigated.
      footer:
        Change-type: patch
        change-type: patch
      author: Kyle Harding
      nested: []
  version: 1.21.8
  title: ""
  date: 2024-04-29T17:17:30.203Z
- commits:
    - subject: Add missing $select for release_asset.asset_key
      hash: 4f4f65c0b2cace726eccbea5d5ed8ed0f8302e54
      body: ""
      footer:
        Change-type: patch
        change-type: patch
      author: Thodoris Greasidis
      nested: []
  version: 1.21.7
  title: ""
  date: 2024-04-19T14:22:55.708Z
- commits:
    - subject: 'Revert "balena-build: avoid using device-type as a prefix in yocto
        sstate"'
      hash: 7a85083784a3225debf2276a978558df5a307ec7
      body: |
        This reverts commit f4a9566941083770151ebe3edd78e9866b4856fb.
      footer:
        Change-type: patch
        change-type: patch
      author: Kyle Harding
      nested: []
  version: 1.21.6
  title: ""
  date: 2024-03-25T14:58:37.715Z
- commits:
    - subject: Merge AMI publishing dependencies into yocto-build-env
      hash: c208a885e849b1b49231de31268a482344220d38
      body: |
        This allows us to build and publish fewer helper images.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.21.5
  title: ""
  date: 2024-03-14T19:05:22.682Z
- commits:
    - subject: "balena-build: avoid using device-type as a prefix in yocto sstate"
      hash: f4a9566941083770151ebe3edd78e9866b4856fb
      body: >
        Yocto already splits the build sstate by target arch, native arch,
        toolchains, and machine where applicable.


        Keeping the caches separated by device type prevents sharing of common
        cache steps between identical toolchains and architectures.
      footer:
        Change-type: patch
        change-type: patch
      author: Kyle Harding
      nested: []
  version: 1.21.4
  title: ""
  date: 2024-03-13T18:16:12.920Z
- commits:
    - subject: Enable S3 Server Side Encryption flags
      hash: 93a2a37249c8262662934e4220c1009a8f22c51c
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.21.3
  title: ""
  date: 2024-02-11T13:57:42.525Z
- commits:
    - subject: "automation/include: Pass helper image version"
      hash: 2a8e25e0d0b46b3249c1c77b0c38219ebcdea1f0
      body: |
        This is needed by the balena-push-env helper image that needs the
        balena-yocto-scripts version but has no way of getting that info
        otherwise.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 1.21.2
  title: ""
  date: 2024-02-08T07:44:50.538Z
- commits:
    - subject: "balena-deploy: Remove docker.io when pulling image"
      hash: bd23b9ad59a1645bce79b0df5ef3879d10774a3a
      body: |
        This seems to cause docker images --format to fail
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alexandru Costache <alexandru@balena.io>
        signed-off-by: Alexandru Costache <alexandru@balena.io>
      author: Alexandru
      nested: []
  version: 1.21.1
  title: ""
  date: 2024-02-07T12:39:41.622Z
- commits:
    - subject: Return image id after pulling helper images
      hash: f2fb17399ede63ceaada8c8625a250747745d97a
      body: |
        Also refactor the pull helper image functions to
        support a single repository with multiple variant tags.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
    - subject: Build and publish helper images with Flowzone
      hash: 8a15692852f38bfd5158b61b5870dffd8f758a64
      body: |
        Rather than build helper images on demand, we will
        publish them to ghcr.io with every revision of this project.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.21.0
  title: ""
  date: 2024-02-02T18:52:51.154Z
- commits:
    - subject: Remove unused block-build functions
      hash: 130d7fb70f4a10755731e898e87610547fe44692
      body: ""
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.20.0
  title: ""
  date: 2024-02-02T16:29:21.897Z
- commits:
    - subject: "automation/balena-deploy: Pin to known working version of balena-img"
      hash: 927310397896f35bd1921202e8b1f30ba3ef47d8
      body: >
        As per internal thread
        https://balena.zulipchat.com/#narrow/stream/345890-balena-io/topic/Jenkins.20build.20failures/near/409602914
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alexandru Costache <alexandru@balena.io>
        signed-off-by: Alexandru Costache <alexandru@balena.io>
      author: Alexandru Costache
      nested: []
  version: 1.19.41
  title: ""
  date: 2023-12-22T16:01:59.872Z
- commits:
    - subject: "Dockerfiles: update balenaCLI version to 17.2.2"
      hash: 635816960ec1f836433a397a420292462bafd2c5
      body: |
        Update balenaCLI from 14.5.15 to 17.2.2 (current latest)
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block.sh: deploy licenses and changelog as release assets"
      hash: 173ab9a844e9c77f46bd5f022a62fc9100b83002
      body: |
        This will make it possible to surface these build artifacts to users.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Add changelog to deployed artifacts"
      hash: 2c55cdc09d5fb38a225b1b11c413de1d5206fb44
      body: |
        Deploying the changelog will allow to deploy it as a release asset.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: add release assets helper functions"
      hash: bb9c5762ff424a9ae8df77d5dcebafa262fbe264
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.40
  title: ""
  date: 2023-11-13T10:19:34.115Z
- commits:
    - subject: "Dockerfile_yocto-build-env: Install rsync and uudecode host
        dependencies"
      hash: 20a981f81a47cf86c62efb57838baa4d45776560
      body: |
        These are required for the UCM-iMX9 build
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alexnadru Costache <alexandru@balena.io>
        signed-off-by: Alexnadru Costache <alexandru@balena.io>
      author: Alexandru Costache
      nested: []
  version: 1.19.39
  title: ""
  date: 2023-10-20T13:47:52.543Z
- commits:
    - subject: README.md ChangeType is needed for PR so add to README example
      hash: 9f554545b218b3d00af08f1b6971605a1617ed22
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex J Lennon <ajlennon@dynamicdevices.co.uk>
        signed-off-by: Alex J Lennon <ajlennon@dynamicdevices.co.uk>
      author: Alex J Lennon
      nested: []
  version: 1.19.38
  title: ""
  date: 2023-10-11T06:39:29.551Z
- commits:
    - subject: "Dockerfile_yocto-build-env: Add screen"
      hash: 7ca8164eec0ba2903b5a463166fdb2d9370d3ba4
      body: |
        To enable us to use `bitbake -c devshell foo` in container
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex J Lennon <ajlennon@dynamicdevices.co.uk>
        signed-off-by: Alex J Lennon <ajlennon@dynamicdevices.co.uk>
      author: Alex J Lennon
      nested: []
  version: 1.19.37
  title: ""
  date: 2023-10-10T13:49:21.732Z
- commits:
    - subject: "flowzone: allow external contributions"
      hash: e44cdd1b12d22ffb6d93408e794defee812436c2
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.36
  title: ""
  date: 2023-10-10T12:37:01.374Z
- commits:
    - subject: "balena-deploy: fail if device type not found"
      hash: 14896d0846e52ce45ed5b14e2b62cb965983c44a
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
    - subject: "balena-api: Dont assume private if can't get DT"
      hash: ae7c2e15e7ce6ee3588e1026653f0e54ff7c39f8
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Ryan Cooke <ryan@balena.io>
        signed-off-by: Ryan Cooke <ryan@balena.io>
      author: rcooke-warwick
      nested: []
  version: 1.19.35
  title: ""
  date: 2023-09-28T08:26:37.671Z
- commits:
    - subject: Remove all traces of --skip-discontinued
      hash: c0974ffb5f64818dcb5040d233348dd95c8e6c40
      body: >
        This option was removed in
        https://github.com/balena-os/balena-yocto-scripts/pull/313
      footer:
        Change-type: patch
        change-type: patch
        Changelog-entry: Remove all traces of --skip-discontinued
        changelog-entry: Remove all traces of --skip-discontinued
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
    - subject: "barys: Remove documenting the --skip-discontinued option"
      hash: 0bd9144ebed207734e7eecb584306b74b25ed53d
      body: >
        This option was removed in
        https://github.com/balena-os/balena-yocto-scripts/pull/313
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 1.19.34
  title: ""
  date: 2023-07-12T07:04:24.994Z
- commits:
    - subject: Update device-types package from v10.3.0 to v10.5.1
      hash: 4bd1b5ed1298013cc2c4e766822b0e6869e83a47
      body: |
        Update device-types package from v10.3.0 to v10.5.1
      footer:
        Change-type: patch
        change-type: patch
        Changelog-entry: Update device-types package from v10.3.0 to v10.5.1
        changelog-entry: Update device-types package from v10.3.0 to v10.5.1
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "barys: remove option to skip discontinued device types"
      hash: a20413eac9cda4c5993841cdd771d904c0e8c0b5
      body: |
        A discontinued device type has the coffee file removed from the
        documentation so there is no need for this argument.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: remove balena_lib_get_dt_state"
      hash: 2bf60f21a4486859760168ecbf4b35af2eec88a1
      body: |
        There is no requirement in balenaCloud to inform about a device
        deprecation. This allows to just remove the coffee file from the
        device repository when a device is deprecated so there will be no
        more releases and no need for checks on a discontinued state.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build: remove discontinued device check"
      hash: db359a88cf3ada613afef703a969e612b1706c2f
      body: |
        There is no requirement in balenaCloud to inform about a device
        deprecation. This allows to just remove the coffee file from the
        device repository when a device is deprecated so there will be no
        more releases and no need for checks on a discontinued state.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: remove discontinued check"
      hash: fe94d22851698916f576647b3a3ada3002b6e352
      body: |
        There is no requirement in balenaCloud to inform about a device
        deprecation. This allows to just remove the coffee file from the
        device repository when a device is deprecated so there will be no
        more releases and no need for checks on a discontinued state.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.33
  title: ""
  date: 2023-07-10T15:29:53.674Z
- commits:
    - subject: "balena-deploy: Newer meta-balena do not create a kernel_source tarball"
      hash: 62660e16161c559653dd2c32196ab94631753ce5
      body: |
        This artifact did not contain kernel sources since Yocto Thud.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.32
  title: ""
  date: 2023-06-19T18:06:35.539Z
- commits:
    - subject: "balena-deploy: add a compressed licenses tarball to the deploy
        artifacts"
      hash: 13ab5d114a679cca3a2df41230e4ad611e1c8292
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.31
  title: ""
  date: 2023-06-05T15:07:23.610Z
- commits:
    - subject: "generate_ami: opt-in secure boot when using signed images"
      hash: 7925369a76060ad9e2adb16856e78cd3ca09b02c
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-generate-ami: comply with default AMI quotas"
      hash: 27d34aa2a35b0bf6d7c1ffb563c1ad65d773e1fc
      body: >
        Comply with AWS public AMI quota, taking into account we have two

        architectures that publish AMI images and we need free slots for custom

        version request.


        Make the oldest public image back to private before publishing a new
        image.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.30
  title: ""
  date: 2023-05-23T18:02:32.156Z
- commits:
    - subject: "balena-deploy: add secureBoot feature into contract"
      hash: 67e694d63918e9911de99f497c39d84dfef28df7
      body: |
        When building signed images, add the secureBoot feature flag into the
        OS contract. This is needed for other components to identify secureBoot
        compatible software releases.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.29
  title: ""
  date: 2023-05-19T11:42:58.818Z
- commits:
    - subject: "jenkins_build: accept bitbake extra arguments"
      hash: 6847515a46b62726e24156f6ce05365dd4f00ea8
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.28
  title: ""
  date: 2023-05-06T15:44:43.740Z
- commits:
    - subject: "barys: fix removal of equals sign from argval"
      hash: 8855ad4d31b45187e4007763b6bb084e08974807
      body: |
        When parsing additional variables to be passed to the bitbake build,
        keys and values are split using equals as a delimiter. However, the
        splitting process does not split only on the first occurrence, which
        results in removing equals signs from the value as well. This is
        problematic with base64 encoded strings, which are padded with equals
        signs.

        Split only on the first occurrence, leaving the value intact.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.19.27
  title: ""
  date: 2023-04-21T22:08:39.297Z
- commits:
    - subject: "balena-lib: Do not return error if no balena user token is available"
      hash: e335e248305cda86ce55f934b2b3ba8202f17454
      body: |
        The balena API token is only required for private device access so don't
        fail if there is not one available.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.26
  title: ""
  date: 2023-04-12T15:18:36.631Z
- commits:
    - subject: "Dockerfile: yocto-build-env: update balenaCLI to 14.5.15"
      hash: 5fe3f9a353668d9197d7f32c0f7cd3789606202b
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.25
  title: ""
  date: 2023-03-01T10:00:57.712Z
- commits:
    - subject: "balena-api: ignore quotes from API replies"
      hash: ad7065112eee4e6e3865ef5581e4c53676536459
      body: |
        The balenaAPI has replied both `OK` and `"OK"` to patch requests. Accept
        any of them as long as they contain OK.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.24
  title: ""
  date: 2023-02-28T18:19:17.093Z
- commits:
    - subject: "balena-generate-ami: increase import snapshot timeout"
      hash: 42434c60b0d86bccf45114cde0d55998399e59b8
      body: |
        The aarch64 images are timing out on import.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-generate-ami: remove s3 temporary image if snapshot import
        times out"
      hash: 0d01c648eb65883099579e03ef914c29bf814e1b
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-generate-ami: match instance type with image type"
      hash: 98c1601e106a1fe194fd6c1339b33b67a57a578a
      body: |
        When using an amd64 AMI, use a suitable A1 Graviton instance to test it.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-generate-ami: fix linter warnings"
      hash: 799fb7e6618ababbfe14c1ee6ee2763e25517538
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.23
  title: ""
  date: 2023-01-28T10:53:40.736Z
- commits:
    - subject: "balena-generate-ami: allow for staging deployments"
      hash: aa127c8c3066c94c5904834f8a18be1e2e6ee39a
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_generate_ami: allow for staging deployment"
      hash: 0ed9b6082a086aca594cffabdbbeafcc541d3277
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.22
  title: ""
  date: 2023-01-25T13:40:41.034Z
- commits:
    - subject: "balene-generate-ami: remove key name"
      hash: cebc5f30447785bdbad8260f0975bd1f9f261a9b
      body: >
        No need to provide a key name as the instance only needs to be
        accessible

        via balenaCloud.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.21
  title: ""
  date: 2023-01-19T12:37:05.534Z
- commits:
    - subject: "jenkins_generate_ami: default to pull cloud-config apps from balena_os"
      hash: 0e3f9ca33265d1fc84244a4e3e86b9e7a7c85715
      body: |
        These applications have been moved to the `balena_os` organization.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.20
  title: ""
  date: 2023-01-18T08:56:44.815Z
- commits:
    - subject: "balena-generate-ami: do not remove AMI snapshot"
      hash: 7022aa4933c5134d22b1f9f7e60c9e76fecca36a
      body: |
        This snapshot is attached to the AMI and can only be removed after
        de-registering the AMI.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_generate_ami: use balena_os tokens instead of org specific
        token"
      hash: 526fe49137cd619162d4e1307b977d1aa85401b0
      body: |
        No need to complicate the job configuration with two tokens if we can do
        with one.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build: respect the preserve build flag"
      hash: 30ff6dc19dafe9f7860df65c5552e4a25061a37b
      body: |
        Do not remove the build directory if the preserve build flag is set.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-generate-ami: cleanup images after deployment"
      hash: 9c9d16e927a472aa06ef7e08ae63d3167747b166
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-generate-ami: test image before making it public"
      hash: 561d67921c0f4251dc4ccdbe41864bc0a565524c
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.19
  title: ""
  date: 2023-01-14T17:40:18.215Z
- commits:
    - subject: "balena-generate-ami: Enable TPM support on x86_64 only"
      hash: 7ee973096d3d93f0006816c310cf41d0d5097d86
      body: |
        On aarch64 this fails with
        "Invalid machineArchitecture value 'arm64' for tpmSupport."
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
  version: 1.19.18
  title: ""
  date: 2023-01-09T08:14:37.524Z
- commits:
    - subject: "jenkins_generate_ami: support using both live and installer images as
        AMIs"
      hash: fa4fcbb106695ba646a383d4efff3cc325626330
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-generate-ami: Enable nitroTPM support"
      hash: 23cb657399160486341dd05cea555504845f1d22
      body: |
        This allows to use secure boot in AMI images.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build: add argument to build OS development images"
      hash: 07f20dae6f06831181fc2ae306f9c4a52499ca24
      body: |
        Building OS development images is useful for example when debugging and
        testing AMI images.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.17
  title: ""
  date: 2022-12-23T15:16:00.319Z
- commits:
    - subject: "dockerfile: balena-push-env: update balena CLI version to v14.5.15"
      hash: 06f4be81c2dd37eb6a6da51024d6857b32200d20
      body: |
        Newer supervisor require a CLI >= v13.5.1 to migrate from v2 apps.json
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_generate_ami: add balena org for preloaded app"
      hash: ee48444b36d3597264a7694b2246b3fee4f6b659
      body: |
        Specify the organization and block name when preloading so it is not
        ambiguous.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_generate_ami: distinguish between staging and production"
      hash: 3a36e81b8a0043cfbbc472dd70b0049b3cef9247
      body: |
        Use different tokens to preload from staging and production.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.16
  title: ""
  date: 2022-12-16T11:06:42.331Z
- commits:
    - subject: "workflows: add flowzone"
      hash: 025f8399061f4a0ca6651d643c8c2016c8b1cfa7
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.15
  title: ""
  date: 2022-12-16T10:49:48.888Z
- commits:
    - subject: "jenkins_generate_ami: use a different token"
      hash: 3fcb9cb302b3f50e5fd8943fdafe2934fb0de182
      body: >
        The AMI preload application no longer lives in the balena_os
        organization

        so allow to provide a different token.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.14
  title: "'jenkins_generate_ami: use a different token'"
  date: 2022-11-10T15:10:52.071Z
- commits:
    - subject: "jenkins_build: Only deploy AMI after deploying a final release"
      hash: cfa6879d11a98c112a2e16fd40b6443a7fa6a838
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.13
  title: "'jenkins_build: Only deploy AMI after deploying a final release'"
  date: 2022-10-21T15:03:17.022Z
- commits:
    - subject: "barys: Add balena-rust to syntax conversion step"
      hash: 2fb2b25a2bc6c226f3d4d570a2bfb261585ed283
      body: |
        Recent versions of meta-balena include a balena-rust layer used to
        specify a distro-set Rust version across all supported Yocto versions

        As such, the syntax of this layer also needs to be converted.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.12
  title: "'barys: Add balena-rust to syntax conversion step'"
  date: 2022-08-08T15:25:50.686Z
- commits:
    - subject: "balena-api: On hostapp creation, set class to app"
      hash: 3bb4995b8bedcfe83b75c3ef6151725828dd1eb8
      body: |
        Applications can be fleet, blocks or apps, and hostapps need to be set
        as apps.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.11
  title: "'balena-api: On hostapp creation, set class to app'"
  date: 2022-07-25T17:11:36.181Z
- commits:
    - subject: "balena-deploy: Use balena-img instead of resin-img"
      hash: 93a91f27b8538d60b45d0f25eb1fddf512e31e52
      body: |
        The resin-img is no longer maintained and the deployment of raw images
        as well as flasher requires features only available in balena-img.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: Global rename from dockerhub resin to balena accounts
      hash: 6f28a6fed6d28f713312b8e856cf6bc6a8bba045
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "automation: Stop deploying images to dockerhub"
      hash: 988886a34945b9e9993abbcf651824b774910740
      body: |
        We are now using just the internal registry.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.10
  title: "'Global rename from dockerhub resin to balena accounts'"
  date: 2022-06-29T14:41:44.861Z
- commits:
    - subject: "balena-deploy: pin balena-img to v4.1.2"
      hash: 5a9efbc151127e6bb806627ba4949327cd54b776
      body: |
        Pin balena-img to v4.1.2, to ensure that upstream changes never break
        the deployment.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
    - subject: "balena-deploy: s/resin-img/balena-img"
      hash: c632941d9f54549df6e9464b317c18bf6a313040
      body: |
        As part of rebranding, resin docker repos were renamed to balena, and
        resin/resin-img no longer receives updates. Change the image we pull to
        process OS images from resin/resin-img to balena/balena-img.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.19.9
  title: "'balena-deploy: s/resin-img/balena-img'"
  date: 2022-06-28T20:10:34.817Z
- commits:
    - subject: "balena-lib: release_finalize: Do not retag phase for ESR branch patch"
      hash: ffdcb572e75b6bddc890710a6c1e4702d08a86a7
      body: |
        When we patch an ESR branch, for example from v2022.1.0 to v2022.1.1,
        do not update the next, current, sunset ESR  phases as they remain the
        same.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.8
  title: "'balena-lib: release_finalize: Do not retag phase for ESR branch patch'"
  date: 2022-06-01T11:14:12.365Z
- commits:
    - subject: "balena-lib: balena_lib_release_finalize: Pass the correct arguments"
      hash: e28b745d4ba121b639ba79dad2377f051fe5d3e2
      body: |
        The balena_api_fetch_fleet_tag requires a slug as first argument, not
        a fleet that can contain the organization too.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Tag ESR fleets with patch independent tags"
      hash: d51ecb6d91fe6ecf91de1ecde4fff700f7f88e67
      body: |
        Otherwise patch updates of ESR branches move the ESR phase when they
        should not. For example, if 2022.1.1 is current, 2022.1.2 is also
        current and should not move 2022.1.1 to sunset.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.7
  title: "'balena-lib: Tag ESR fleets with patch independent tags'"
  date: 2022-05-31T19:39:43.444Z
- commits:
    - subject: "balena-lib: Check versions before finalizing"
      hash: 0ae1389a69b857b466b4eef81396d5f1b6bc4ae6
      body: |
        Only allow to finalize draft releases that have matching semver with
        the device repository being deployed.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: Do not always finalise on deploy"
      hash: 754833d6ef773b68a9eecafb426783ac70eb8767
      body: |
        Introduce a new final step after draft deployment to finalise releases.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: Add OS version to contract"
      hash: 2c692984079215c2c916c5e4df79e200486be1ff
      body: |
        If there is an OS contract, add the OS version we are building for.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Generate OS contract if not available"
      hash: 2205c4de1dadafbf26f9f7b303b88c4da6d7710e
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Build contracts"
      hash: b8c08faf2a86434793bcad67e063ade9754142ff
      body: |
        Add a function to build all OS contracts and return the one for the
        specified slug.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: Add generate-oscontract script
      hash: 20894636355622ab0ded6b2e6a4f804f78961d99
      body: |
        This script generates OS contracts for all device types.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.6
  title: "'Configure Renovate'"
  date: 2022-05-24T10:16:21.892Z
- commits:
    - subject: "jenkins_build: Finalize when required"
      hash: 85728e3fdc27f988af5383f320858eba5056e8d4
      body: |
        If the build job is set to finalize then do so.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Finalise release before tagging"
      hash: 2243ff38f3589c021c0013477b92e6888f57eba8
      body: |
        This is so we can check that we are tagging the correct version before
        doing it, as tagging makes the release visible.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: Add function to get final state of release"
      hash: 3e2e25182d45801e8e4df9908170e73d4696f81a
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Extract release finalization as function"
      hash: 969f6b941bd9fb34d82fbc0d48838b7b4898b2e1
      body: |
        This allows it to be called from other context, like the OS automation
        test suite.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: Update balena-cli version to latest
      hash: 13cdae57ddaa8e37f8a9a5d0c2873c2964cd3d31
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Fix header on balena_deploy_block()"
      hash: dbbf059bf9b8df60b7578c7a41e0678fbff60043
      body: |
        The arguments to this function have been re-ordered but the header had
        not been modified.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.19.5
  title: "'Build and deploy'"
  date: 2022-05-19T17:25:06.676Z
- commits:
    - subject: "balena-api.inc: fix 'fatal: unsafe repository'"
      hash: b467ef7d676d77e1057b1b9a1180075b9b82012e
      body: |
        Git 2.35.2 was released to fix a security issue with multi-user
        machines. Add `device_dir` to the whitelist to avoid this error.

        Also, let's make sure an error is thrown when the hostapp cannot
        be made public.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 1.19.4
  title: "'Add dir exceptions for newer git'"
  date: 2022-04-28T11:28:28.873Z
- commits:
    - subject: "balena-lib: fix 445d6d1fcfce97f85ffcfedc0083eb658a734321"
      hash: d8a3a47e87dc65b81451e5dd07213577cc9fe82b
      body: |
        Commit 445d6d1fcfce97f85ffcfedc0083eb658a734321 does not fix
        the issue because it is missing the --global arg without which
        the git config command fails.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 1.19.3
  title: "'balena-lib: fix 445d6d1fcfce97f85ffcfedc0083eb658a734321'"
  date: 2022-04-26T08:40:52.078Z
- commits:
    - subject: "balena-lib: fix 'fatal: unsafe repository'"
      hash: 445d6d1fcfce97f85ffcfedc0083eb658a734321
      body: |
        Git 2.35.2 was released to fix a security issue with multi-user
        machines. Add `device_dir` to the whitelist to avoid this error.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.19.2
  title: "'balena-lib: fix 'fatal: unsafe repository''"
  date: 2022-04-21T23:56:18.934Z
- commits:
    - subject: "deploy: ensure deployRawArtifact is empty instead of null"
      hash: 56edfe62d6ecede3e07b0b51653ca605a2e4ba83
      body: |
        jq returns null by default when a given key isn't found, ensure that
        when getting the value of deployRawArtifact, we get an empty variable
        instead, which is checked later on to determine if that file should be
        deployed
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.19.1
  title: "'deploy: ensure deployRawArtifact is empty instead of null'"
  date: 2022-04-14T16:02:35.647Z
- commits:
    - subject: "deploy: push image variant artifacts"
      hash: f5b7ae35f2f2996d93ba572919e26e1487a79f79
      body: ""
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.19.0
  title: "'deploy: push image variant artifacts'"
  date: 2022-04-13T14:36:11.268Z
- commits:
    - subject: Bump balena-cli to v.Latest
      hash: 6aec14bf20674e62822ba41f56ef2763c4036b6d
      body: |
        * remove SSH key injection
      footer:
        Change-type: minor
        change-type: minor
      author: ab77
      nested: []
  version: 1.18.0
  title: "'Bump balena-cli to v.Latest'"
  date: 2022-03-31T20:52:47.275Z
- commits:
    - subject: Remove superfluous preload flag
      hash: a124b525ca058ead27eb43c0a799eb692c79fa80
      body: ""
      footer:
        Change-type: patch
        change-type: patch
      author: ab77
      nested: []
  version: 1.17.12
  title: "'Remove superfluous preload flag'"
  date: 2022-03-29T17:38:21.495Z
- commits:
    - subject: Unattended preload operation
      hash: 1fecbb4d000b1a403f192a63d5e2921ded56647c
      body: >
        * the CLI prompts for input during preload


        Alternatively, the --pin-device-to-release flag may be used to pin only
        the

        preloaded device to the selected release.


        Would you like to disable automatic updates for this fleet now? No


        * we do not want to set the suggested flag and we do not want to touch
        the fleet release policy for this use case
      footer:
        Change-type: patch
        change-type: patch
      author: ab77
      nested: []
  version: 1.17.11
  title: "'Unattended preload operation'"
  date: 2022-03-29T14:36:18.054Z
- commits:
    - subject: Pass environment to docker
      hash: ac8be68fb073aed53b21b2e66df4fb54adb64e22
      body: ""
      footer:
        Change-type: patch
        change-type: patch
      author: ab77
      nested: []
  version: 1.17.10
  title: "'Pass environment to docker'"
  date: 2022-03-28T17:26:04.107Z
- commits:
    - subject: "automation: ami: make BALENA_PRELOAD_COMMIT optional"
      hash: b365cb9ba359637a3a6a8451b8d83142bb167571
      body: |
        Remove BALENA_PRELOAD_COMMIT from required env vars, as we have a
        default if it's not specified.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.17.9
  title: "'automation: ami: make BALENA_PRELOAD_COMMIT optional'"
  date: 2022-03-25T23:25:09.583Z
- commits:
    - subject: "balena-deploy: s/resin-flasher/balena-flasher"
      hash: abdae4c86ed213a64bb1fa7498f4837f53d95448
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.17.8
  title: "'balena-deploy: s/resin-flasher/balena-flasher'"
  date: 2022-03-15T20:11:21.544Z
- commits:
    - subject: "jenkins_generate_ami: surface preload app commit as variable"
      hash: 7248b344198ba09a219ee227ffea4b6f0a4850d7
      body: |
        Surface the preloaded app commit as a variable that can be overridden in
        the build job. Default to "current" to maintain existing behavior when
        the variable isn't set.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Joseph Kogut <joseph@balena.io>
        signed-off-by: Joseph Kogut <joseph@balena.io>
      author: Joseph Kogut
      nested: []
  version: 1.17.7
  title: "'jenkins_generate_ami: surface preload app commit as variable'"
  date: 2022-03-15T16:36:33.654Z
- commits:
    - subject: "barys: Remove RESINHUP setting"
      hash: 367f153009928f36de8edcd97a56d6f58b5d6773
      body: |
        This has now been removed from meta-balena.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.17.6
  title: "'barys: Remove RESINHUP setting'"
  date: 2022-03-08T19:00:31.730Z
- commits:
    - subject: "balena-deploy: Avoid patching test suites config.js during deploy"
      hash: 21c27cd41cda7ee7f5041752cca1f79280c51a7e
      body: |
        This will allow us to make changes to config.js in meta-balena without
        breaking the deploy steps. If additional changes are needed at runtime
        the substitutions can be made by the leviathan Jenkins job.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.17.5
  title: "'balena-deploy: Avoid patching test suites config.js during deploy'"
  date: 2022-03-08T13:38:17.771Z
- commits:
    - subject: Init and update submodules when switching meta-balena branches
      hash: 5162e7c9fa39498488303caab7d746456fc9abd4
      body: |
        If the submodule was recently added to meta-balena, the checkout
        command will not initialize it without a separate submodule update
        command.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.17.4
  title: "'Init and update submodules when switching meta-balena branches'"
  date: 2022-03-03T16:46:17.542Z
- commits:
    - subject: "jenkins_build: Use recurse-submodules when checking out meta-balena"
      hash: 00fb29b9a7a00dc1209be497ef171736e6229954
      body: |
        If meta-balena has submodule updates we want to make sure to use them.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.17.3
  title: "'jenkins_build: Use recurse-submodules when checking out meta-balena'"
  date: 2022-03-02T17:17:21.631Z
- commits:
    - subject: "prepare-and-start: Remove balena login"
      hash: 67568d3a5eceb45ee65c245baae18fa299366f9e
      body: |
        The login will happen as needed.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.17.2
  title: "'prepare-and-start: Remove balena login'"
  date: 2022-02-25T09:19:00.323Z
- commits:
    - subject: "balena-deploy.inc: Do no deploy device logo to deprecated endpoint"
      hash: 54ad619b8b9c00d7c52cfc90593b22c70233d973
      body: |
        As per https://jel.ly.fish/a533a6bd-1c98-412c-ae60-8427e3f7b005,
        the /device-types/v1 endpoint is deprecated and we can remove
        the logo from the device repos so we can also stop handling it
        from here. Instead, the logo will be used from the hw contracts.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Florin Sarbu <florin@balena.io>
        signed-off-by: Florin Sarbu <florin@balena.io>
      author: Florin Sarbu
      nested: []
  version: 1.17.1
  date: 2022-01-27T07:38:18.417Z
- commits:
    - subject: "balena-lib: Fix fetching meta-balena base version"
      hash: d5d838339ed23ecd242092bf4214fe2505ccd181
      body: |
        On an ESR branch the VERSION file contains the ESR version, not the
        base meta-balena version.

        Replace it with searching down the git tree for the commit before the
        branch.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build-block: Use true/false for ESR variable"
      hash: 24876740b2299d092ea3cd1b54f61a020d12a5ba
      body: |
        Keep the same boolean format as in the rest of the files.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: Label ESR hostapps"
      hash: 1c6561daf9f16e579d55305471274e7793dc3619
      body: |
        ESR hostapps need special labels in order to be recognized. This commit
        adds the esr-current, esr-next and esr-sunset labels.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: add balena_api_fetch_fleet_tag"
      hash: 2ced90fc432298abf14e00d4ac58cc8eaf003b24
      body: |
        Add a function to retrieve fleet tags.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: Set policy on ESR hostapps"
      hash: 6e4d7b3d2ccbd1a5c67d94cc73c4552775ce3b94
      body: |
        ESR hostapps need an esr release-policy in order to be recognized.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Pass ESR variable when creating apps"
      hash: 2497bfb59ae16810169718e6d383d0bc9d564a04
      body: |
        ESR hostapps need special labels in order to be recognized. This allows
        to add those flags when creating the hostapp.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.17.0
  date: 2022-01-20T12:30:21.992Z
- commits:
    - subject: "balena-deploy: Deploy passing the latest meta-balena version and not
        tag"
      hash: 9d5fa316dbda3d4782e782abaceed41efe3e5a99
      body: |
        The last meta-balena version and tag might not be the same, like in the
        case of ESR branches.

        Fixes #249
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Add balena_lib_get_meta_balena_base_version"
      hash: 25840dc98e138781e78530be0437f3950970f263
      body: >
        Retrieves the last meta-balena version, which may not be the same as the

        last meta-balena tag.


        For example, when we branch an ESR release, the meta-balena branch is

        tagged with the ESR name, like 2.83.x, while the last meta-balena
        version

        will be a proper semver.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.16.4
  date: 2022-01-18T09:50:54.889Z
- commits:
    - subject: "balena-deploy-block: Check for existing tag only in specific hostapp"
      hash: 8893fd94bc0cc31a7fa7af8a87af68a69fec908d
      body: |
        The same version tag can exist across different hostapps.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.16.3
  date: 2022-01-17T17:18:11.734Z
- commits:
    - subject: "balena-api: Propagate balena API environment, token and OS organization"
      hash: 64c2854c85aafebf80e6a13b725ff610ae25a467
      body: |
        This is required to allow building against cloud instances with
        different names for the balenaOS organization and private device types.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-build.sh: Propagate balena API environment and token"
      hash: 35d39c4a400df0552bfb3d875c8a9d1289ad8d4e
      body: |
        This is required to use the API for private slugs.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "prepare-and-start: Propagate balena API environment and token"
      hash: bb7b903e00fc153afea182a330da08a49b72cced
      body: |
        The balena-build.sh script accepts a token in the command line. This
        commit modifies the prepare-and-start.sh script to use it if
        available, and also modifies it to take into account the balena
        environment too.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.16.2
  date: 2022-01-15T16:04:34.389Z
- commits:
    - subject: "revert_overrides: Add intel-quark to architecture overrides"
      hash: cbcbbc42c10700c77e17d8f9224e35bec90280fe
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.16.1
  date: 2022-01-11T14:37:00.027Z
- commits:
    - subject: "balena-deploy: Check for file existence before deploying"
      hash: 36494bf99a08b68a5afac5038d4691a583d01500
      body: |
        When discontinuing a device type, there are no artifacts apart from
        device-type.json, so check that the logo is there before deploying.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: Check existence of tag before re-deploying"
      hash: c1a5b20b0ef0d04a30b6bf0bcfacf0a527e931ae
      body: |
        If a release is already tagged with this version, issue a warning and
        bail out.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: Add function to check the existence of a release tag"
      hash: bdc2146c3ad719f5c7335aeb7b4ee43775a20ac7
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: Finalize releases when deployed"
      hash: 1e3768132d87295998bd9a17d0f01121e161e312
      body: |
        For now and until a proper CI/CD workflow is in place, finalize releases
        on deployment.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: Accept deployments without balena.yml
      hash: 23c1f91993f37a18ade26ceef621e24409be5f74
      body: |
        If no balena.yml file exists, the deployment will go through without
        setting a release semver.

        For the time being we are still using a version label in the hostapp.

        This commit will be reverted once we get rid of the version label.
      footer:
        Change-type: patch
        change-type: patch
        Changelog-entry: Accept deployments without balena.yml
        changelog-entry: Accept deployments without balena.yml
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_generate_ami: Remove variant from image name"
      hash: 0fe3d6c8d0ebff85248f0bed99750186f05ab686
      body: |
        The OS is now a unified image so there are no variants.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-build.sh: Stop building OS variants"
      hash: 4e65c83e7808e91c99e335609142401e0031ed23
      body: |
        The OS is now a unified image so there are no variants.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build.sh: Remove buildFlavor"
      hash: b66f7ce58f0c12f78941ed34eb311bbd3a96af1c
      body: |
        The OS is now a unified image so there are no build flavours.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build-blocks: Remove variant build option"
      hash: e7fb9fc8354445bcbc05687e1f96aa0e8025ecc9
      body: |
        The OS is now a unified image without variants.
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Stop using .dev/.prod variant suffixes"
      hash: 65c030b986f62b0faaddba501520662a8ac2777d
      body: |
        The OS has now a unified image that can be configured to be development
        or production mode.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: Stop tagging hostapp releases with variant"
      hash: 3fc5efeeef4ae74e499504c1148932539a49c28e
      body: |
        The API will stop using the variant tag but will still use the version
        tag.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Use externalVersion to match contracts"
      hash: 385c5bacfc1452e4b065de55bfdf71727b303fff
      body: |
        The version refers to the actual contract, while the externalVersion is
        the one that refers to the balenaOS revision.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build: Deploy hostapp like any other block"
      hash: bfe7f51dc75f335d38fa4dbf824fa887be8d82ee
      body: |
        Use common functions for block deployments
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build-blocks: Separate block build release deployment"
      hash: 70fe00969921bbf6894cc86ecb343eb342c6f2ca
      body: >
        Separating the build and release of blocks allows to use common code for

        block release.


        Also, pass a flag to specify whether the block should be deployed as
        final

        release.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: Use release versioning"
      hash: d1c74d0261f17ebcad9825bc7e0df22142da14a3
      body: |
        Deploy as draft releases by default. Final releases will be flagged
        once validation passes.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build: Remove discontinued check"
      hash: 55774ee27f938bbcbb238aa6441680b3d39172c3
      body: |
        Individual deploy functions now bail out for discontinued device types,
        there is no need to check for it here.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Do not deploy discontinued device types"
      hash: f54251e61c466018072e04c344595b3eba70bf57
      body: |
        Check for discontinued device types before deploying to dockerhub or
        to balenaCloud.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Discontinued device types use meta-balena version"
      hash: bbecd72c64bf8ff1277a10c03cb39fbf99748e05
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Adapt balena_deploy_block to release versioning and use
        it"
      hash: cfc0bc43af1fb60ff3ddd56f08ae781edaa90b68
      body: |
        * Convert balena_deploy_build_block to balena_build_block, and deploy
          with balena_deploy_block
        * Remove balena_deploy_hostapp and replace with balena_deploy_block
        * Modify balena_deploy_hostos to use balena_deploy_block
        * Modify balena_deploy_block to use release versioning

        By deafult image deployments happen as draft versions, and only become
        final when passing validation.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-build-block: Remove image release"
      hash: 443269afbe867cb5c464ca5dd91bf27aa51427bd
      body: |
        Deal with the release separately so we can use common code for it.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: Use release revision for fetchers"
      hash: f501ac55e327af0db2142a146423e83f459e0c1f
      body: >
        When fetching images for blocks, use a given release revision.


        Also, add token autentication to the API calls that miss it so that they
        work

        with private device types.


        Finally, fix indentation.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build-block: Remove release version API setter"
      hash: 8e27328a0caec2acc7651dfe64f8dfc5510e48e0
      body: |
        When using the now deprecated release_version field, the API would
        reject deployments for an existing release.

        On the new versioning model, deployments increment a revision field so
        there is no need to check for uniqueness.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: Remove release version API setter"
      hash: 42486a59654047cf42f19bd999ef0bcd0a279ea5
      body: |
        This functionality has now been deprecated in the balena API is favour
        of draft/final release versioning.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Use release versioning"
      hash: de2c7af440c1ae4d6f84c5440368f92333500389
      body: |
        BalenaCloud has now a release versioning feature that deprecates the
        use of release_version.

        Introduce a new balena_lib_release() function that utilises a balena
        contract and the CLI to set the release version.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.16.0
  date: 2021-12-30T15:08:43.225Z
- commits:
    - subject: "balena-deploy: Set leviathan networkWireless mode based on device slug"
      hash: 891fadcbabe422e24245beb720cf7326a5ea1136
      body: |
        These changes are currently made in the Jenkins job, so it's preferrable
        to have it done by the packaging scripts.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.15.10
  date: 2021-12-02T21:08:09.863Z
- commits:
    - subject: Substitute the worker types for generic device slugs
      hash: 7539caf732975a5b114abc371a5f6df211d12812
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.15.9
  date: 2021-11-26T19:20:31.029Z
- commits:
    - subject: "Dockerfile_yocto-build-env: Install Honister host deps"
      hash: efc069c609431965394912d3ffd34362a1108852
      body: >
        See
        http://docs.yoctoproject.org/next/migration-guides/migration-3.4.html#new-host-dependencies
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alexandru Costache <alexandru@balena.io>
        signed-off-by: Alexandru Costache <alexandru@balena.io>
      author: Alexandru Costache
      nested: []
  version: 1.15.8
  date: 2021-11-03T10:01:44.980Z
- commits:
    - subject: "jenkins_build.sh: Fix deployment for discontinued device types"
      hash: 84e65e937fef38625277fb8330ebd3179c466d04
      body: |
        Do not deploy dockerhub or hostapp images for discontinued device types.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build.sh: Remove PRIVATE_DT as it is unused"
      hash: 35fd54620ff5eb487b1323a1ead5fef9c157e385
      body: |
        The private device types status is checked with the API when required.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build.sh: Fix lint warnings"
      hash: 068a4197101a2db4aba60793e01564b67d14f820
      body: |
        Fix some minor lint warnings.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.15.7
  date: 2021-10-25T16:57:03.955Z
- commits:
    - subject: "balena-generate-ami.sh: wait for boot partition when preloading AMI"
      hash: d2ea170a86810a782eeb241e178d4ad72c4939b0
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
  version: 1.15.6
  date: 2021-10-21T15:04:37.774Z
- commits:
    - subject: "jenkins_generate_ami.sh: Use a shared directory for preloaded image"
      hash: 9b032f2fddc970db13147b4e637abd1bada1f234
      body: >
        The previous commit moved the preloaded image out of yocto cache, which

        made it unreachable from the balena-generate-ami-env container.


        This patch makes mktemp create the file back within yocto cache to
        ensure

        this is shared yet still each concurrent process can safely have its own
        copy.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
  version: 1.15.5
  date: 2021-10-21T04:50:17.146Z
- commits:
    - subject: "barys: update development image variables"
      hash: 427510332026ca8636dedb6630632a740b481374
      body: |
        Update the DEVELOPMENT_IMAGE references to use OS_DEVELOPMENT
        following the changes to the handling of OS variants.
      footer:
        Change-type: patch
        change-type: patch
        Changelog-entry: "barys: update development image variables"
        changelog-entry: "barys: update development image variables"
        Signed-off-by: Mark Corbin mark@balena.io
        signed-off-by: Mark Corbin mark@balena.io
      author: Mark Corbin
      nested: []
  version: 1.15.4
  date: 2021-10-20T09:40:14.890Z
- commits:
    - subject: "jenkins_generate_ami.sh: Preload outside of yocto cache"
      hash: fb1763984d76218adc2510da6cb673fbad7197be
      body: >
        Since the file name is hardcoded at this moment, this fails when two

        builds are running in parallel (e.g. dev and prod variants during
        deploy)

        because they try to preload the same file at pretty much the same
        moment.

        Having a separate copy for each outside of yocto cache should fix the
        issue.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
  version: 1.15.3
  date: 2021-10-20T05:12:57.093Z
- commits:
    - subject: "balena-generate-ami.sh: correctly mount boot partition when injecting
        SSH key"
      hash: c0f6da3e4fe3f9c51ba8b279986a6f4baffe6d96
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
  version: 1.15.2
  date: 2021-10-01T14:45:58.407Z
- commits:
    - subject: Update balena-cli to 12.50.1
      hash: 700ebe6d06385440488a42c42179d19434376209
      body: |
        This is necessary for AMI preloading to work, additionally
        it has been more than a year since the last update, we should keep up.
      footer:
        Change-type: patch
        change-type: patch
        Changelog-entry: Update balena-cli to 12.50.1
        changelog-entry: Update balena-cli to 12.50.1
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
  version: 1.15.1
  date: 2021-10-01T10:11:14.438Z
- commits:
    - subject: "jenkins_generate_ami.sh: Use lib function to get arch from config.json"
      hash: fffe9ffb363c9eed783a5055e69847c81eb68bcd
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "balena-generate-ami.sh: Look for boot partition by label rather than
        hardcoding p1"
      hash: 45786e701d05811f96d0aeef20481442bb1d0f1c
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "balena-generate-ami.sh: Fail if AMI already exists"
      hash: 9e9a792aed2a659c1ed7327237a61594033b308a
      body: |
        This was only ignored for development purposes, we should not replace
        released images.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "balena-generate-ami.sh: sync after writing config.json"
      hash: f0838aaee9751a6fb60558a7646d597b1f99b1c3
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "balena-generate-ami.sh: Stick to POSIX-compliant [ instead of [["
      hash: 2c6a97c263a71c63387290fca29ba5b01eba8db4
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "balena-generate-ami.sh: Remove useless statements"
      hash: 9d4ac02f3ad8eadaed79703dbc859c4950449810
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "jenkins_generate_ami.sh: Use architecture as suffix instead of machine
        name"
      hash: 7d2e3911defedc500b3b1ded3268dbe74bb523b0
      body: >
        This removes the necessity for the DT being named generic-*. It also
        means

        all the DTs of the same architecture will preload the same app.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "jenkins_build.sh: pass MACHINE to jenkins_generate_ami.sh"
      hash: 0e33582e2860474e1c6aff5275539b1333aef6b9
      body: |
        This removes the dependency on JOB_NAME from jenkins_generate_ami.sh
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "AMI automation: Adjust AMI names to be compatible with AWS API"
      hash: bc91b7036b32aa57c053c115ac87b7f21fa634c8
      body: ""
      footer:
        Change-type: patch
        change-type: patch
      author: ab77
      nested: []
    - subject: "AMI automation: Correct S3 bucket name and key"
      hash: 8864adcb20c1f4cbfd48e422dbae44b885c8ca06
      body: ""
      footer:
        Change-type: patch
        change-type: patch
      author: ab77
      nested: []
    - subject: "AMI automation: Add a separate container for generaing AMI"
      hash: d7d91ff4c3ea655dfa9a483a020d2d16aa5e0f49
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Michal Toman <michalt@balena.io>
        signed-off-by: Michal Toman <michalt@balena.io>
      author: Michal Toman
      nested: []
    - subject: "AMI automation: shellcheck and resolve violations"
      hash: 6b11dd26bc1229aafed98c5933f23e892811f49f
      body: ""
      footer:
        Change-type: patch
        change-type: patch
      author: ab77
      nested: []
    - subject: "AMI automation: Use staging env by default"
      hash: 21fa55a6f73faf59fe5fc3b1e6e8bc4084e17c01
      body: ""
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Toms Tormo <tomast@balena.io>
        signed-off-by: Toms Tormo <tomast@balena.io>
      author: Toms Tormo
      nested: []
    - subject: "AMI automation: Simplify public ssh addition. Do not use sudo"
      hash: dd96771607f79620a241e4dee99879542643f55f
      body: ""
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Toms Tormo <tomast@balena.io>
        signed-off-by: Toms Tormo <tomast@balena.io>
      author: Toms Tormo
      nested: []
    - subject: "automation: Generate and publish AMI from the raw balenaOS image"
      hash: efe2b5beb5ea6b00fff07372a312c7e0c690654b
      body: ""
      footer:
        Change-type: minor
        change-type: minor
        Signed-off-by: Toms Tormo <tomast@balena.io>
        signed-off-by: Toms Tormo <tomast@balena.io>
      author: Toms Tormo
      nested: []
  version: 1.15.0
  date: 2021-10-01T04:12:24.310Z
- commits:
    - subject: "balena-deploy: When deploying hostapp default to using slug as name"
      hash: d9ee5fa5f5a97de9c41c2acc13b6c7335e2b043f
      body: >
        Using the device type is incorrect as aliases are not taken into account.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: Do not use balena_lib_resolve_aliases"
      hash: d50cee134436914b4960254abd0a5cf28b40f764
      body: >
        That function is now for internal use, replace with
        balena_lig_get_slug()

        which is clearer.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena_lib: Make resolve_aliases local so it is not globally used"
      hash: 45a0f62debdbf9e20d56e8bba8a9567359d7e8e4
      body: |
        The correct call is balena_lib_get_slug(device_type), which resolves
        aliases too.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.14.9
  date: 2021-08-20T17:33:15.811Z
- commits:
    - subject: Use slug when setting deviceType for leviathan
      hash: bc628771aa0014e86e649e3312b48e1c7ae4968c
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.14.8
  date: 2021-07-22T14:51:50.560Z
- commits:
    - subject: "balena-lib: Fix print statements helper functions"
      hash: 45ccecc6945a06c3975c4ffc782bef5770f30ae7
      body: ""
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
    - subject: "balena-lib: Fix device dir when running in Jenkins containers"
      hash: 95530d134ea729359e7e1e19fac109dd6d40ca5c
      body: |
        Avoid returning an empty path when we are running in containers
        where /work does not exist.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Kyle Harding <kyle@balena.io>
        signed-off-by: Kyle Harding <kyle@balena.io>
      author: Kyle Harding
      nested: []
  version: 1.14.7
  date: 2021-06-29T20:20:09.994Z
- commits:
    - subject: "balena-deploy: Flag hostapps as bootable apps"
      hash: 4093fe7397b52cc58d676f2d7b3db3699c8a8b92
      body: |
        This will mark the app as isHost.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Provide working directory when deploying hostapp"
      hash: c20241cdf161ca8f438c38e84f504dadfaeeadc0
      body: |
        When creating a public app, the workdir is used to retrieve the URL
        used in the public app creation.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.14.6
  date: 2021-06-18T10:49:05.763Z
- commits:
    - subject: "balena-deploy-block: Do not add variant suffix to release tag"
      hash: 084154ac3c3d0d6d3ec4c7d2a21590815a61bb2f
      body: |
        Fix the legacy way of tagging releases with a string variant and the OS
        version as this is still being used by the UI.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.14.5
  date: 2021-06-18T09:06:25.918Z
- commits:
    - subject: "Dockerfile_balena-push-env: Add balena-lib to image"
      hash: 937026182287183bffbdc6836c707d34532bc509
      body: |
        The balena-api library requires functions in balena-lib.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy-block: source balena-lib script library"
      hash: 4b05b3ea6b3d42add1926547809e29213ce84890
      body: |
        Some functions in balena-api require this library.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.14.4
  date: 2021-06-16T10:37:10.537Z
- commits:
    - subject: "balena-api: Filter out debug output"
      hash: bbb7ec875bd4b0d56c878187eb1d00e8d450b5d8
      body: |
        Change a json dump for a debug function call.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-api: Specify API environment and token when setting app roles"
      hash: c2402322ef608cb207494c37ade33a531734d9ca
      body: |
        The defaults only work with the production environment.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "jenkins_build-blocks: Separate recipes and packages"
      hash: 0b7c0a0a14141bbeb6b29171763cac99d68d9830
      body: >
        Currently we are reading a package list from the contracts that mixes

        recipe and package names, and we run bitbake with the `-k` flag not to

        stop the build when a package name fails to match a recipe.


        The contracts have now been modified to specify either a
        `sw.recipe.yocto`

        or a `sw.package.yocto` so we can distinguish between them and use

        recipe names to build and package names to install.


        We also remove the continue flag from bitbake.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: Generalize contract fetcher"
      hash: 2d01048848734b580b89bfdd41df13ef10a8d31f
      body: |
        Instead of fetching a package list, fetch a composedOf list passing a
        type. This allows to fetch `sw.package` and `sw.recipe` types.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-deploy: Shorten installation directory '/yocto/resin-board' to
        '/work'"
      hash: 20baa1d287d95f95cb84797586afa73ed52f2db1
      body: |
        The installation directory is currently "/yocto/resin-board". This is
        too long for the creation of per-task balena-engine sockets which have
        a maximum path length of 104 characters.

        This commit replaces the installation directory with "/work".
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: Conditional verbosity mode
      hash: 6bb1fa2d08c2e3128b5a02588cb009ded98eb0da
      body: |
        Also, fix some linter warnings.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.14.3
  date: 2021-06-01T11:48:30.209Z
- commits:
    - subject: "balena-lib: Add function to fetch labels from image"
      hash: a987a933ad52af6c7935b19f13f4f39f0be157f1
      body: |
        Image labels are used to handle the installation of images.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-lib: contracts: Add package list fetcher"
      hash: f2e5ce081f9ef39bcff364ce4a8e9a9d0d806590
      body: >
        Add functions to retrieve a package list from a sw.package contract
        where

        a yocto package based hostos block is defined.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "semver: Add bash utility for semantic version comparison"
      hash: 831c494a1bc1f286a9b95f22cc86ade46f336a89
      body: >
        From https://github.com/Ariel-Rodriguez/sh-semversion-2


        MIT licensed:
        https://github.com/Ariel-Rodriguez/sh-semversion-2/blob/main/LICENSE
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
    - subject: "balena-docker: Add image retrieval function"
      hash: 79d8a1b201196e2730bcf1d92c8be19dbd693106
      body: |
        Common image retrieval code.
      footer:
        Change-type: patch
        change-type: patch
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.14.2
  date: 2021-05-26T09:34:20.890Z
- commits:
    - subject: Add a parsable representation of the changelog
      hash: 9bbc4207170e8db4e79c0d139653570fdc013f95
      body: >
        This file allows other components to uniquely parse the information that

        is contained in the changelog. It will be automatically managed by

        versionist by appending the new commits on top. This is needed to

        provide nested-changelogs.


        Generated with
        product-os/versionist/blob/master/scripts/generate-changelog.sh
      footer:
        Change-type: patch
        change-type: patch
        Changelog-entry: Add a parsable representation of the changelog
        changelog-entry: Add a parsable representation of the changelog
        Signed-off-by: Alex Gonzalez <alexg@balena.io>
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      author: Alex Gonzalez
      nested: []
  version: 1.14.1
  date: 2021-05-24T09:59:21.687Z
- version: 1.14.0
  date: 2021-05-21T19:44:08.000Z
  commits:
    - hash: 5999d8421b8cb83f42ecbd98201b2b5b9ff9648c
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Add yocto-block-build-env container to build Yocto based hostOS blocks
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_yocto-block-build-env: Add container to build Yocto based
        hostOS blocks"
      body: >-
        This container is based on the `balena-push-env` helper container and
        includes

        an opkg application built from source. It is used to build Yocto IPK
        packaged

        based hostOS blocks.
    - hash: dcb1ee52f56d4785cc4a6b93d33c2b63f2bcda12
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Balena build and deploy a hostOS yocto ipk block image
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build-block: Balena build and deploy a hostOS block image"
      body: Balena builds and deploys a hostOS block from a Yocto ipk package feed.
    - hash: 285e72e2107b5c7693ebe70ee5041d2001507f98
      author: Alex Gonzalez
      footers:
        change-type: minor
        changelog-entry: Add script to build hostOS blocks
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build-blocks: Add package blocks builder script"
      body: This script builds hostOS blocks as defined in their contract
        specification.
    - hash: 5f6a285d43ce7b161601174b11d7c9b8771b9799
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy: Add functions to deploy block, feed and OS release"
      body: Add the logic for block and OS deployment.
    - hash: 1b551c71da050d84005f80cd076ec9abe8569b0a
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "README: Add brief introduction to the main scripts"
      body: |-
        Add a short description of the helper build scripts that this repository
        offers.
- version: 1.13.0
  date: 2021-05-19T11:16:23.000Z
  commits:
    - hash: 2f185e83de39c9e18aedafe9afe55a18758d6696
      author: Alex Gonzalez
      footers:
        change-type: minor
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "barys: Replace supervisor tag with supervisor release version"
      body: |-
        The latest meta-balena fetches the supervisor from the internal registry
        using the release version.
    - hash: 74a5bcaa4761f1f0bdf7ea8fba153540d33e2313
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Replace supervisor tag with supervisor release"
      body: |-
        The latest meta-balena fetches the supervisor from the internal registry
        using the release version.
    - hash: 84958c3687ca2424903414ed2304937e11776b16
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Rename metaResinBranch to metaBalenaBranch"
      body: Rename variables to match current brand.
- version: 1.12.16
  date: 2021-05-18T16:10:59.000Z
  commits:
    - hash: 1b138ac2f6f5a1751947a5a28e64f80747244069
      author: Kyle Harding
      footers:
        change-type: patch
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "tests: Substitute deviceType with MACHINE when packaging tests"
      body: null
- version: 1.12.15
  date: 2021-05-18T16:05:32.000Z
  commits:
    - hash: 5dd3cd943d76d06835bcf6a6233cc2060bd230b9
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_yocto-build-env: Specify docker version"
      body: |-
        This matches as closely as possible the version of the dind container
        used in the Yocto build.
    - hash: 830377a4530fa755334b2060a732a944122c86b4
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-docker: Allow to control iptables and ipmasq flags"
      body: >-
        When running multiple daemons, we don't want them to clash managing

        iptables so we start redundant daemons with iptables and ipmasq set to

        false.

        By default we enable both which is the current dockerd default.

        When running a single docker daemon without the iptables and ipmasq
        flags,

        containers on the default bridge network cannot communite with the

        outside as no iptables rules are set.
- version: 1.12.14
  date: 2021-05-17T17:08:35.000Z
  commits:
    - hash: bc841cf22273bc24f1b6710e8d4c95adaa8e1908
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Set default argument value not to exist on nounset setting"
      body: |-
        Scripts sourcing balena-api might set nounset, so assign empty values
        to optional arguments not to trigger an early exit.
    - hash: 094faf7defe8f3e5bdccb86cc88afb5eda13a635
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Allow access to OS developers to public apps"
      body: |-
        This allows the OS developers to see these applications with their
        Balena account tokens.
- version: 1.12.13
  date: 2021-05-14T13:25:06.000Z
  commits:
    - hash: f7737b535ce6e81994db4225dea2a5f48607373e
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Add functions for apps management"
      body: Add utility function to manage balenaCloud apps.
    - hash: 6938b8feec5d5ac5e92ed25c702b1fc4953e931e
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Add block images getter functions"
      body: |-
        Add a set of utility functions to retrieve release images and parse them
        according to their labeling.
    - hash: 513b525a141ccb16796218b8b8b5a67a36faf208
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Add missing argument to function comments"
      body: This is a non-functional change.
    - hash: 899122243bf47c20247eaa800cd55a3ff37c4886
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy-block: Create public app if required"
      body: |-
        The script will, given the correct token, create a public app if it does
        not exist.
    - hash: 5a86b9edc5e91c9164a976eb4c4f5ba41141c830
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Fix device installation path when running in helper
        container"
      body: >-
        Several functions require to know where the device installation
        directory

        is, and this differs when the scripts are copied to a container.
    - hash: 960f754b2b86a9264155bf9763b148674a5e2db5
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy: Fix device installation path when running in helper
        container"
      body: >-
        Several functions require to know where the device installation
        directory

        is, and this differs when the scripts are copied to a container.
- version: 1.12.12
  date: 2021-05-12T09:20:22.000Z
  commits:
    - hash: 86d1af439c807258eaa577e50dfb8a172f50f9af
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-docker: Adapt to be used from POSIX shell"
      body: Also, fix indentation to use tabs.
    - hash: ba5fbfd03adea5895f88c7dd2e9223d5fbee33f0
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Generalize balena-docker to any engine
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-docker: Generalize functions to any engine"
      body: This is so it can be used both for balena-engine and docker.
    - hash: adbe6807cbdd603a229bc466a9e954b9bbef9cfc
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Re-enable the container's output"
      body: Remove the pseudo tty from the docker run command.
    - hash: 9fb2417d73e8e5f4a0eeb0d457aac0b0327c8c49
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Add option to keep local containers"
      body: |-
        This is helpful when developing locally not to continuously download
        the helper images.
    - hash: 8d7b725471e27ea8d4eb21d68b1e9855d4f5bbf1
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "yocto-build-env: Update Dockerfile to add host tools dependencies"
      body: |-
        In preparation for replacing docker with balena-engine, add the required
        host dependencies.
    - hash: 8462659f7d2d738fcf736ce89085224d8ae79d3b
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: Shorten installation directory '/yocto/resin-board' to '/work'
      body: |-
        The installation directory is currently "/yocto/resin-board". This is
        too long for the creation of per-task balena-engine sockets which have
        a maximum path length of 104 characters.
        This commit replaces the installation directory with "/work".
- version: 1.12.11
  date: 2021-05-11T19:09:14.000Z
  commits:
    - hash: 35d9b65e8078215c5240132add8d48331a37c2da
      author: Kyle Harding
      footers:
        change-type: patch
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: Substitute device type in config.js if present
      body: null
- version: 1.12.10
  date: 2021-04-28T13:19:51.000Z
  commits:
    - hash: e702ddec1b9ee297f212ff6f2d74a26cee9448ee
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: print submodule status"
      body: |-
        Print the details of all submodules so that layers that are not part of
        bblayers, like balena-yocto-scripts, also get their sha1s displayed on
        build.
    - hash: 562d2120770041a50f7daebbf4660ccace1ee51f
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Correctly pass development images flag and amend usage"
      body: |-
        The development image flag is not being correctly passed to barys.
        Also, attemps to make the usage instructions clearer.
- version: 1.12.9
  date: 2021-04-22T09:11:29.000Z
  commits:
    - hash: c897e1a23ea163180100cf0b4bd90ae207535fbd
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Pass the API environment to the build container"
      body: This allows to target builds to non-production environments.
    - hash: 4fb71f2d09e621ef6a070dd8e28f093a8a81adf0
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Add function to resolve between contract slugs and Yocto
        machines"
      body: |-
        Some device types have different Yocto machine names than contract
        slugs, so provide a function to translate.
    - hash: 4e8425ceab16ea6ad516438c8ffd5b968e0feaa0
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Do not exit if no SSH_AUTH_SOCK defined"
      body: |-
        Environment that build public device types will probably have no use
        for ssh authentication, so print a warning but  go on.
    - hash: ee9533ec9c3cdf8236cd92fe37aa382d5cc19214
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Fix indentation"
      body: No functional changes.
    - hash: 5131302a1cb8351d5b05b41249a7808af5935a73
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Cleanup build containers and enable build output"
      body: |-
        It is useful to know what the build output is. Also, not leaving
        containers around is important for the builders storage size.
- version: 1.12.8
  date: 2021-04-15T10:50:06.000Z
  commits:
    - hash: 554cb42fad058032a093258bd779989d5f815941
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Fix development image build"
      body: |-
        The development image flag is being set to the variant instead of a
        yes/no string.
    - hash: d83f1779fe8771f3e8fb0ad1e4a5ca3b2d0928fa
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build-containers: Use a fixed length for the git short revision"
      body: |-
        The short version length could be configured differently on different
        git installations so this commit specifies the length.
    - hash: 22d97d0e9f887c614c3e6a14bec3167e52d85ad8
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Do not err when sourcing without a repository"
      body: |-
        A global variable uses git to retrieve a sha1 revision. If this fails
        with the errexit option the script exists after sourcing this file.
        This commit masks the error as it may not be needed in the sourcing
        script.
        Also, fix the length of the short git release to avoid different git
        clients configuration mismatches.
- version: 1.12.7
  date: 2021-04-12T15:58:51.000Z
  commits:
    - hash: 8e98a1347803e53d2d3a4d77fded345adf1671ad
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Improve logs when setting version"
      body: |-
        The set release version function would print a success message even when
        the patch operation failed.
    - hash: f53f813640d8104c5a9d2028c22e2b9d7725f070
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-docker: Make it less verbose"
      body: Hide debug messages unless the DEBUG variable is set.
    - hash: 86a275ad03a07223ce42cb3c704211b71922f73d
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy: Set the OS version before setting deploy directory"
      body: The local build directory is expected to include the OS version.
- version: 1.12.6
  date: 2021-03-30T11:32:20.000Z
  commits:
    - hash: 00153cf459855572cf94c632477c38034bb361d2
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "include: Move include files and entry scripts into its own folder"
      body: Cosmetic reorganization, no functional changes.
    - hash: 5c5669a8d6901b4a28ad952d367774e7c8cb3a90
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build.sh: Move into build script"
      body: This is a containeirized barys so it should live along barys.
    - hash: 7dbf390cdf5a88f349dac1323b1c85cf579f4cc7
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Set default namespace if not defined"
      body: |-
        The namespace variable can point to an alternative registry and it is
        useful for developing. This commit sets the default when not defined.
- version: 1.12.5
  date: 2021-03-30T08:34:48.000Z
  commits:
    - hash: a0a6a337a82bb4527d71db3d8457688fe32af02e
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy: Shellcheck warnings"
      body: Remove shellcheck warnings. No functional changes.
    - hash: 9237debc97aef84d21f042494bd4d017e29182f9
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy-block: Adjust variables for common use"
      body: |-
        This script is called either to deploy a bootable block (hostapp) or to
        deploy a standard block. This commit makes the environmental variables
        match for both use cases.
    - hash: 8508ea1401107cc5d0a7d3c3026b57bbc5f69bb4
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy-block: Fix shellcheck warnings"
      body: No functional changes, just fixing linter warnings.
    - hash: 0f6b0753c8d8deffc62f58717528f4f577d85eb3
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy: Adjust balena_deploy_hostapp to new balena_deploy_block
        entrypoint arguments"
      body: |-
        The arguments to balena-deploy-block.sh have been modified so it can be
        used from multiple places.
    - hash: c65bdb09be42904dce36ec4bb9c44804329ccd41
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy.inc: Pass API environment to balena_lib_token"
      body: Also, do not exit on error but return.
    - hash: c9d8f8299c5ad6a720d596f8d2b5a6a458fa31c7
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Pass an API environment to balena_lib_token"
      body: Assure logging to the desired environment.
    - hash: 1c479d353fcbf5c1289e3ea52fb0f769d43bd99b
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Pass API environment to balena_lib_token"
      body: Assure which environment we will log into.
- version: 1.12.4
  date: 2021-03-29T12:15:27.000Z
  commits:
    - hash: 6ecd2184bad07ff9226d96de67bb19af03aa367b
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Add is_dt_private function"
      body: |-
        This looks for a device type JSON file and outputs whether the device is
        a private type.
    - hash: 6ca8f284de6d94e0d9db3e50f31410142080fefa
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Add several function to extract device details from device
        type JSON file"
      body: These are utility functions used from other scripts.
    - hash: a275b3ab8f5bc1ae3a6ec7545dfc0f4faca725cf
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: By default only login to BaleneCloud if not token is found"
      body: This avoids redundant logging call to the API.
    - hash: 4a83bb9c440059a2e1c153a70385b5bb6e312ebf
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena_deploy: Add functions to deploy Jenkins artifacts to S3 and
        dockerhub"
      body: |-
        These have been extracted from `jenkins_buils.sh` so that they can be
        reused if required.
    - hash: c02c3d7467d4127cb4611afb5fc3388a7d417600
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy: Fix indentation and shellcheck warnings"
      body: Non functional cosmetic changes.
    - hash: cb77f35d4e52f7e44af458746a2e1ba1e1b8c8a6
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Call out to script libraries functions"
      body: This simplies the script and makes it more legible.
- version: 1.12.3
  date: 2021-03-26T18:28:05.000Z
  commits:
    - hash: 47fa0f615a7f884673109b482631f3abcfc2a374
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Fix indentation to tabs"
      body: Match the file style and use tabs to indent. Only cosmetic changes.
- version: 1.12.2
  date: 2021-03-26T18:13:45.000Z
  commits:
    - hash: 6c842342f475915d622ea8f55fe5c5f9b7c45b8e
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-docker: Remove execution trace flag"
      body: This is a leftover from development.
- version: 1.12.1
  date: 2021-03-25T08:55:29.000Z
  commits:
    - hash: 29a08c98639c68d146b9e4c9f36121c81f098cf2
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Add commonly used utility functions"
      body: >-
        Add functions to obtain Balena environment, token and login to the
        cloud,

        as well as to retrieve both OS and meta-balena versions.
    - hash: bb538a7010b47b17a11e26f800feed162d712d2f
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build-containers: Allow docker login for local development"
      body: |-
        Only fix user and password from environment when in a Jenkins context.
        This allows to rebuild and deploy helper images to user repositories for
        local development
    - hash: 295800c173833e6857258faaf1ace2a09dc7339a
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Add bitbake-args argument to barys and make bitbake-target
          accept multiple arguments
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "barys: Add bitbake-args argument and make bitbake-target accept
        multiple arguments"
      body: |-
        This commit extends barys so it accepts a list of bitbake arguments
        and/or target images. This will allow the flexibilty needed to build
        blocks with barys as frontend.
    - hash: bc926eecd3d7acb629b3709a3e89e935ae0f18c5
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Separate deploy functions"
      body: |-
        In future we will stop deploying to dockerhub and deploy only to
        balenaCloud.
    - hash: 0c52eeb67ff088b27569b304ee7547a24aef3c29
      author: Alex Gonzalez
      footers:
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Refactor balena_lib_get_os_version"
      body: null
    - hash: ceded8430b5b404ed5157e0decf1f95a8cd09d52
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-api: Add script library with API calls"
      body: |-
        This library is to be sourced by scripts that need to use the API to
        obtain app or image specific information.
    - hash: dd5fa7375182bd03d2e37a53af7982d2d96ce825
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-push-os-version: Rename to balena-deploy-block and set the
        release version on deploy"
      body: >-
        Until "balena deploy" has this functionality let's perform a direct

        API call.

        Production versions have the OS release name and development versions
        get

        appended a .dev suffix. Once both image variants are merged only the OS

        release name will be used.
    - hash: f3c8ea277d799ca3c9ae5c263e08db332d40aac6
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_balena-push-env: Refactor to use balena-deploy-block"
      body: Rename to use balena-deploy-block.
    - hash: 576b5dc53fa04709111866b290f31fda62740867
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-build: Split build related functions"
      body: This script can be used standalone to call barys on a containerized
        environment.
    - hash: d924527622c55e584889ebbb91e0500e8cbd21d4
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Separate barys build functions"
      body: |-
        Separate the call to barys to a scritpt library so it can be reused from
        other scripts.
    - hash: 9067812829783ad75636917b82c3229746c10c51
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-deploy: Add script library for deploy logic"
      body: |-
        Centralize all the deploy login in one script library starting with
        balena_deploy_hostapp.
    - hash: 0ab60de60dc2e45f222b07acb7283cde02131863
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Use balena_deploy_hostapp from balena-deploy"
      body: Use the same function call on all scripts that require to push a hostapp.
- version: 1.12.0
  date: 2021-03-25T08:47:27.000Z
  commits:
    - hash: 5df25c78ca0b0ad68013e4b7e3cd2ef50e55e785
      author: Kyle Harding
      footers:
        change-type: minor
        changelog-entry: Improve template layer matching
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "barys: Improve template layer matching"
      body: |-
        The current method does not support multiple layers named with names
        following `meta-balena-*` so this change will search for the required
        `bblayers.conf.sample` file before assigning the template layer.
- version: 1.11.2
  date: 2021-03-22T19:46:16.000Z
  commits:
    - hash: ac91198049a0bae1ced3c05e9b795f1e78b69370
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Allow to specify which containers to build and login to
          dockerhub so that they can be deployed
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build-container: Do not overwrite environment DOCKERFILES
        variable if provided"
      body: >-
        Also, do not duplicate the variable that specifies current script
        directory

        and perform a docker login so that new images can be deployed.
    - hash: 1fe8f585cef6ca9592d1ee3929d32b838f272833
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Rename to balena-lib.inc"
      body: This indicates it is to be sourced and not executed.
    - hash: e9d3dc9c9816a72cbd62f0b247c36364fe168be5
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Rename functions with the balena_lib prefix"
      body: >-
        This makes them easy to identify and makes it clear where they come from

        making the code more legible.

        Also, remove balena login from `balena_lib_docker_pull_helper_image`
        function

        as the login is performed by the container deployment script.
    - hash: 111843536ad9c951f0850256b8a56d9f4c612816
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Use balena-lib.inc instead of balena-inc.sh"
      body: Adapt to the refactoring of balena-lib.
- version: 1.11.1
  date: 2021-03-22T12:50:36.000Z
  commits:
    - hash: 6c349d535232e6c8dc1e7b5f32aba39cd436cadb
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-docker: Rename manage-docker to balena-docker"
      body: Convert manage-docker into a script library so it can be re-used.
    - hash: 7c79c2109455c54b9d09938416c47463fc8bb652
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-push-os-version: Refactor to use balena-docker"
      body: Use common scripts to manage the docker instance
    - hash: 2deb988b1c9da918fd0729f64039140884f6e63d
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "prepare-and-start: Refactor to use balena-lib"
      body: Use common script to manage docker instances
    - hash: 943839ff2210c7db9030d3deca00c99c41f1253e
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_yocto_build-env: Refactor to update dockerd and use
        balena-docker"
      body: |-
        Use common scripts to manage docker instances, and update the dockerd
        daemon to the distribution supported stabel version.
    - hash: 5fb8f5c74565096ede89e42985f9b7ad7d59ef4a
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_balena-push-env: Refactor to use balena-docker"
      body: Use common scripts to manage the docker instance.
- version: 1.11.0
  date: 2021-03-02T18:51:04.000Z
  commits:
    - hash: 8bfa1e399a2a947c4ba4fb76c843b2701d5f6165
      author: Kyle Harding
      footers:
        change-type: minor
        changelog-entry: Rename resin image types to balena
        depends-on: balena-os/meta-balena#2118
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "balena-yocto-scripts: rename resin image types to balena"
      body: |-
        As part of a full rename away from legacy resin namespaces the
        following device compatibility changes are required to align
        with meta-balena changes.
        - packaging scripts
    - hash: b5cf2879c4b42d6653ffcd2b4c1493463e445fdb
      author: Kyle Harding
      footers:
        depends-on: https://github.com/balena-os/meta-balena/pull/2118
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "balena-yocto-scripts: bulk rename of RESIN_ variables"
      body: |-
        This is just a bulk rename of all the RESIN_ yocto variables
        to BALENA_. Compatible changes are required in meta-balena and
        the device layers.
- version: 1.10.3
  date: 2021-03-01T14:47:27.000Z
  commits:
    - hash: af972553510e032098e4e5e54f68bdeba355b1af
      author: Kyle Harding
      footers:
        change-type: patch
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "tests: fix typo in tests packaging"
      body: null
- version: 1.10.2
  date: 2021-03-01T13:52:23.000Z
  commits:
    - hash: 43cb318a7bef0ae8bcd3f538863d4f6081aaee8b
      author: Kyle Harding
      footers:
        change-type: patch
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "tests: strip leading paths when packaging"
      body: null
- version: 1.10.1
  date: 2021-02-26T07:52:26.000Z
  commits:
    - hash: 33596854de04994542f290823f24b50e1fc57a21
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "Dockerfile_yocto-build-env: Install required python3-distutils module"
      body: |-
        Otherwise bitbake fails with the following error:
        Your Python 3 is not a full install. Please install the module
        distutils.sysconfig (see the Getting Started guide for further
        information).
- version: 1.10.0
  date: 2021-02-25T21:28:35.000Z
  commits:
    - hash: c77c068ae70cba0fde6f9697f45802eec0ec726d
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "yocto-build-env: Add balena-cli to container image"
      body: |-
        We need the balena CLI in order to pull images from Balena's internal
        registry.
    - hash: 271fdec2ae67c5e35dbd24a2748ea0829d63a769
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_yocto-build-env: Update Ubuntu version to bionic"
      body: |-
        Keep the Ubuntu version of the helper containers in sync and updates the
        poky/yocto package dependencies to the ones defined in the 3.0 Quick
        Start Guide.
    - hash: 49bb740ff66cbe5308fc1b457075e18dcbaf9c3b
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_balena-push-env: Install node from correct distro source"
      body: |-
        When the base container was updated to bionic the node source distro was
        not updated accordingly.
    - hash: bce4f534e1a6904a7dd8f45bf0da87455a6a2541
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Fix balena devices dockerhub password"
      body: This needs to be a variable and not a string.
    - hash: fe7bf75cb23d39671b8e4b019977b0566d9e707d
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Return the current repository revision"
      body: Enable the calling script to use the newly pulled image by tag.
    - hash: 8110121c0e3f397810495b293594c93123b5110f
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build-containers: Use revision of the repo where the scrip
        lives"
      body: |-
        We want to tag with the revision of the balena-yocto-scripts repository,
        and not the repository from the script that calls it.
    - hash: ff291a72e7e9fca3174e0348d0207ccea0542277
      author: Alex Gonzalez
      footers:
        change-type: minor
        changelog-entry: Use version controlled helper containers
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Use the helper containers that corresponds to this
        revision"
      body: |-
        Instead of using the master tag of the helper containers, use the ones
        that correspond to the current repository revision.
- version: 1.9.6
  date: 2021-02-25T13:39:19.000Z
  commits:
    - hash: 981f7e8e0023965777d46f68393246eb4517d966
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-lib: Add scripts library"
      body: This file allows to share snippets across scripts.
    - hash: 6bf24cac8f93180a5eabc2e7de8dcfffea3dd95e
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Helper containers are now referenced by tag instead of using
          latest, and will be built and deployed if required
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins-build: Dynamically build helper containers"
      body: |-
        Instead of using the master tag of the helper containers, use those with
        a tag that matches the repository revision.
        Also build and deploy them if none are found.
        Fixes balena-os/balena-yocto-scripts#179
- version: 1.9.5
  date: 2021-02-25T11:19:07.000Z
  commits:
    - hash: bacde12299d319d5da7004a5f7c37ff8a4750996
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Generalize balena-push-os-version container helper image to
          push any image type
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "balena-push-os-version: Generalize application name"
      body: |-
        Do not assume that the target application name is always the slug. This
        allows to push non-hostapp type of images, like hostapp extensions.
    - hash: a04a30c18f215d3c21527a46adaef1b5ad3416d6
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "barys: Allow to pass multiple bitbake targets"
      body: This allows to build specific packages.
    - hash: 3afa0b6ba7d5d6fd32391c473c44489c09034c81
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins-build.sh: Generalized target image names"
      body: >-
        Do not assume that the target image to push is always a resin-image.
        This

        allows to push other type of images like hostapp extensions.
    - hash: 263a755feb557e7e651c7c9bd01f6a2ea355311f
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: The jenkins_build script will now preserve the deploy folder
          too when the preserve build flag is set.
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Also preserve deploy folder if preserve build is
        requested"
      body: |-
        Currently the deploy folder is always erased even if the preserve build
        flag is set. For cases where there are several steps in the build, we
        may want to preserve the deployed artifacts from all build steps.
    - hash: 192228e0d2ab89a840643e7084d68da8e408c455
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins-build: Correct build flavor usage"
      body: The build flavor can only be production (prod) or development (dev).
    - hash: ce2c480150f74f85f6853dc0931030acf887e779
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "prepare-and-start: Login to Balena's registry if credentials are
        provided"
      body: |-
        In order to pull from Balena's registry the docker client needs to login
        first.
    - hash: 82d85e8e1e4e865149ee8d3caba407d14731df90
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins-build: Allow the build container to authenticate with the
        registry"
      body: |-
        This is required for the Yocto build process to pull images from the
        hostapp extensions apps in the Balena registry.
    - hash: f047a72cd460f5b64bdf325ec5572aecceaec7e8
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build: Parametrize the docker registry repository"
      body: |-
        This allows to test with images of a different registry and will also
        make it easy to remove the use of resin in the future.
    - hash: 6cf2845aebd4c367367eb7952581dc50aefbef36
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "jenkins_build_containers: Extract repository name into variable"
      body: This allows to easily replace the target repository.
    - hash: 346abf9ee5ff8c27a652773308c32862689cf6ee
      author: Alex Gonzalez
      footers:
        change-type: patch
        changelog-entry: Update Ubuntu version on balena-push-env helper container image
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "Dockerfile_balena-push-env: Update Ubuntu version"
      body: |-
        This is required so that this image can be used as a base of the hostext
        one which needs to build opkg.
- version: 1.9.4
  date: 2021-02-23T16:39:28.000Z
  commits:
    - hash: 9991e55eff17d60bd6f7f27010bb067935375f3f
      author: Kyle Harding
      footers:
        change-type: patch
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "jenkins: compress test suites inside jenkins artifacts"
      body: null
- version: 1.9.3
  date: 2021-02-16T13:17:02.000Z
  commits:
    - hash: 1b634c61314156b055d31624b8c3086bacb98efd
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: 'Revert "esr: Add branch creation automation script"'
      body: >-
        This reverts commit 6b6a6b36696d678666ebe67c3dc64d7a1717c422.

        This script has now moved to:

        https://github.com/balena-os/os-automation/blob/master/new-esr-release/esr_release.py
- version: 1.9.2
  date: 2021-02-12T17:51:38.000Z
  commits:
    - hash: 6b6a6b36696d678666ebe67c3dc64d7a1717c422
      author: Alex Gonzalez
      footers:
        change-type: patch
        signed-off-by: Alex Gonzalez <alexg@balena.io>
      subject: "esr: Add branch creation automation script"
      body: null
- version: 1.9.1
  date: 2021-02-11T15:04:18.000Z
  commits:
    - hash: 8736c72fcabced1a457c3f67f3a0b29a1487f5ff
      author: Kyle Harding
      footers:
        change-type: patch
        signed-off-by: Kyle Harding <kyle@balena.io>
      subject: "jenkins: deploy test suite from meta-balena"
      body: |-
        If leviathan test suites are found in the checkout of
        meta-balena we should package them up with the jenkins artifacts.
- version: 1.9.0
  date: 2020-11-09T08:10:35.000Z
  commits:
    - hash: 72fa6f0c0d834454c6c336b3467ea36857fce202
      author: Stevche Radevski
      footers:
        change-type: minor
        signed-off-by: Stevche Radevski <stevche@balena.io>
      subject: Check DT privacy against the API
      body: null
- version: 1.8.2
  date: 2020-10-23T08:05:10.000Z
  commits:
    - hash: 26ece0ca6a2a7d96aaa6b635a936516137fcc830
      author: Joseph Kogut
      footers:
        change-type: patch
        signed-off-by: Joseph Kogut <joseph@balena.io>
      subject: "build-device-type-json: show stderr on failure"
      body: |-
        When building a device type JSON manifest, any syntax error is handled
        by printing a message about node being unavailable, even when it's
        installed and working.
        Check that node is installed and executable before building the
        manifest, and exit early with the existing message if not. Otherwise,
        print stderr to the console for debugging.
- version: 1.8.1
  date: 2020-09-02T14:03:19.000Z
  commits:
    - hash: 8419251fac6fa25be324c899b2911fcba1457d8b
      author: Alexandru Costache
      footers:
        change-type: patch
        signed-off-by: Alexandru Costache <alexandru@balena.io>
      subject: "README: Remove resin occurrences in documentation"
      body: null
- version: 1.8.0
  date: 2020-06-22T13:59:41.000Z
  commits:
    - hash: d7aa97fe1a61f49c37929d1220c78949b9c4e7d5
      author: Giovanni Garufi
      footers:
        change-type: minor
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Push images to S3 as the first step, and then create the docker and
        balena
      body: resources
- version: 1.7.2
  date: 2020-05-20T18:10:09.000Z
  commits:
    - hash: 6629005788f0f10342910ad18ecd11ea49711040
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Update balena-cli version to 11.35.4
      body: null
- version: 1.7.1
  date: 2020-05-15T08:14:02.000Z
  commits:
    - hash: b94a590ef09ed2cec51ac88ba165eb8251c5f982
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Fix s3 bucket reference
      body: null
- version: 1.7.0
  date: 2020-05-13T15:46:18.000Z
  commits:
    - hash: c0f2de6520984f0b49b7612098ae31473d36412d
      author: Stevche Radevski
      footers:
        change-type: minor
        signed-off-by: Stevche Radevski <stevche@balena.io>
      subject: Manage deploying private device types
      body: |-
        Set S3 access policy to private for private DT
        and don't deploy private DT to dockerhub
- version: 1.6.0
  date: 2020-05-06T11:56:03.000Z
  commits:
    - hash: 794192efe637d54b69e4ba9bec656badff29d77a
      author: Giovanni Garufi
      footers:
        change-type: minor
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Stop pushing images in the resinos folder
      body: |-
        Theses images were used to serve unconfigured images to download, these
        requests are now going directly through the image maker
- version: 1.5.6
  date: 2020-02-28T20:24:57.000Z
  commits:
    - hash: 2e3ab0378ef071e887e2b2453f6c349255e0f60a
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Fix passing additional argument to barys"
      body: null
- version: 1.5.5
  date: 2020-02-28T16:29:17.000Z
  commits:
    - hash: 65d4243b613b4728b81ea4fe230a7a5d5bae4fdb
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Allow for passing additional arguments to barys"
      body: |-
        This is useful for passing SD8887_FROM_SOURCE=1 for example so that
        the Balena Fin Jenkins job will compile the wifi and bt driver from
        source.
- version: 1.5.4
  date: 2020-01-31T19:17:13.000Z
  commits:
    - hash: 5c5b6dfaab2cb2ba8e1de5a138a5f7e15488d23b
      author: Thodoris Greasidis
      footers:
        change-type: patch
        connects-to: "#166"
        hq: https://github.com/balena-io/balena/issues/1818
        see: https://github.com/bloomreach/s4cmd#--api-contenttypestring
        signed-off-by: Thodoris Greasidis <thodoris@balena.io>
      subject: "jenkins_build.sh: Set a content-type to the device type's logo.svg"
      body: |-
        This is needed so that browsers can load the logo.
        Since s4cmd doesn't have a `modify` command, I
        had to `put` the logo again.
- version: 1.5.3
  date: 2020-01-28T11:07:49.000Z
  commits:
    - hash: 920d4e8b1c14d9375a4f4f54282502060eb4587f
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Rename balena push script for clarity
      body: null
- version: 1.5.2
  date: 2019-11-15T16:04:35.000Z
  commits:
    - hash: 9a5529a01ac8ec424b476fef322f18ccf90fdce8
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Update balenaos account to balena_os
      body: null
- version: 1.5.1
  date: 2019-11-15T07:38:12.000Z
  commits:
    - hash: 71061256c4ff97230857f8c9c2c98707366b0e19
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Tag ESR releases with meta balena base version
      body: null
- version: 1.5.0
  date: 2019-11-13T15:06:25.000Z
  commits:
    - hash: 727d92be558e934ca61156700c5909b31286c0b7
      author: Giovanni Garufi
      footers:
        change-type: minor
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Push ESR images to private esr bucket
      body: null
    - hash: 63c3a17050db12a21465d316a9a159d3687263da
      author: Giovanni Garufi
      footers:
        change-type: minor
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Remove line information from release
      body: null
- version: 1.4.1
  date: 2019-11-12T11:37:42.000Z
  commits:
    - hash: 177292b90753cadba82936f19858b3c05df94909
      author: Roman Mazur
      footers:
        change-type: patch
        signed-off-by: Roman Mazur <roman@balena.io>
      subject: Change ascii art to represent balenaOS
      body: null
- version: 1.4.0
  date: 2019-10-10T14:02:56.000Z
  commits:
    - hash: 97edc19568694f6f93a3d242dd3c7feeded90ae6
      author: Giovanni Garufi
      footers:
        change-type: minor
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Add ESR-line parameter
      body: null
    - hash: 77b65730b3ada70763179c0723f43491d3c715d5
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Fix docker push script
      body: null
- version: 1.3.9
  date: 2019-10-07T08:34:16.000Z
  commits:
    - hash: 94cd1f5925328cff32d4889fca4db92ab41719c0
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Push OS image to balena and set version tags
      body: |-
        Also tags variant and status untested.
        Adds another Dockerfile that will be built by jenkins for the
        balena-push-env container.
        Unified some common behaviour for starting and stopping docker in a
        single script.
- version: 1.3.8
  date: 2019-09-30T11:13:48.000Z
  commits:
    - hash: e65e6631c3273c80344e60602c780263cf0c1c56
      author: Gergely Imreh
      footers:
        change-type: patch
        signed-off-by: Gergely Imreh <gergely@balena.io>
      subject: "barys: correctly apply SUPERVISOR_TAG variable in local.conf"
      body: >-
        Setting `--supervisor-tag` to enable building for a specific supervisor

        tag sets the `SUPERVISOR_TAG` value. That is the correct variable

        to set according to meta-balena (see at
        https://github.com/balena-os/meta-balena/blob/8d5057b45e1965e6c27c03a95d2211ae47842331/meta-balena-common/recipes-containers/resin-supervisor/resin-supervisor.inc#L20
        )

        but in the device types' `local.conf.sample` the `TARGET_TAG` variable

        was set, see for example
        https://github.com/balena-os/balena-raspberrypi/blob/078b0add0345e94f27c15d98256f8c7b61b66761/layers/meta-balena-raspberrypi/conf/samples/local.conf.sample#L45-L46

        and thus barys' setting was not applied.

        Looking at the available recipes, the `SUPERVISOR_TAG` should be set

        and in the device types' `local.conf.example` files should be updated

        to refer to that instead of `TARGET_TAG`.

        With this change this can be implemented in two steps:

        * the current PR updates `SUPERVISOR_TAG` if exists or appends if it
        doesn't (or the

        update has failed) in local.conf and allows using the relevant barys
        flag again

        * in other per-device repo PRs then the `local.conf.example` can
        separately updated,

        to be less misleading, on its own schedule
- version: 1.3.7
  date: 2019-09-10T16:08:09.000Z
  commits:
    - hash: 857757aa2e5182cb75081d88b5cc5b6028cac677
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: Support building older resin OS releases
      body: null
- version: 1.3.6
  date: 2019-09-10T13:36:52.000Z
  commits:
    - hash: c9deac3531ffeea86e2737cb1093dd4646ac5e58
      author: Sven Schwermer
      footers:
        change-type: patch
        signed-off-by: Sven Schwermer <sven.schwermer@disruptive-technologies.com>
      subject: "git: Ignore package-lock.json"
      body: |-
        Since this file seems to be generated by the barys script and it's not
        supposed to be checked in, let's ignore it.
- version: 1.3.5
  date: 2019-07-15T13:28:41.000Z
  commits:
    - hash: a1004eeba326624c1f08b4b918af6354d7b767ec
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Use dsync instead of deprecated sync command"
      body: |-
        The sync command is deprecated in s4cmd in favour of dsync. And also
        the existing deprecated sync command in s4cmd does the sync in a
        different manner from the s3cmd sync command in the sense that it
        makes a copy of the local dir in the remote dir and in our case we
        end up with duplicate dirs in the target path.
- version: 1.3.4
  date: 2019-07-15T11:24:00.000Z
  commits:
    - hash: d12cb46cc58e1438794767bfdc8f75b50ec7a9f9
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Use put command with -f for latest file"
      body: |-
        We need to use -f (force overwrite) otherwise s4cmd fails:
        [Thread Failure] File already exists: <s3_bucket>/latest
- version: 1.3.3
  date: 2019-07-15T10:03:23.000Z
  commits:
    - hash: 04f766dba3d3bb7d51a8a60af020e55e1adcd7eb
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Use canned ACL and remove obsolete option"
      body: |-
        Since s4cmd does not have the "--acl-public" option we use the new
        --API-ACL option that allows us to set canned ACLs for the objects
        we upload to S3. We use the "public-read" canned ACL that does:
        "Owner gets FULL_CONTROL. The AllUsers group gets READ access."
        Also we remove the "--skip-existing" option which is not present
        in s4cmd.
- version: 1.3.2
  date: 2019-07-15T08:42:31.000Z
  commits:
    - hash: 7ba1acfe22b851c865bc0cb8bc63fa6aaa62bf9f
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Use s4cmd del command instead of rm"
      body: |-
        Since we switched from s3cmd to s4cmd we also need to use the
        del command because s4cmd lacks the rm command.
- version: 1.3.1
  date: 2019-07-12T14:49:23.000Z
  commits:
    - hash: b6d16c56376506b9bfaf4652aa1d8a027e8cf24e
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Use new s4cmd params for accessing s3"
      body: null
- version: 1.3.0
  date: 2019-07-12T10:15:47.000Z
  commits:
    - hash: c29e9023a05c081f1566599e9ad2d97f1bf006ec
      author: Florin Sarbu
      footers:
        change-type: minor
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Switch s3cmd with s4cmd"
      body: |-
        The resin-img docker image has changed to open-balena-base 8.0.0
        which in turn is based on debian:buster. This version of debian
        does not include the s3cmd package in it's repositories anymore.
        Instead it provides a replacement package called s4cmd
        (https://packages.debian.org/buster/s4cmd) which "is intended as
        an alternative to the existing s3cmd tool, enhancing performance
        and support for large files, and coming with a number of additional
        features and fixes".
- version: 1.2.3
  date: 2019-06-24T12:56:12.000Z
  commits:
    - hash: f4bf4d5e206701e4d9b4bede30759055ecda56ac
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Rename device type icon to logo.svg"
      body: null
- version: 1.2.2
  date: 2019-06-24T11:18:36.000Z
  commits:
    - hash: 0a01b11ad084c752e83ff19ec21f915c539b4629
      author: Florin Sarbu
      footers:
        change-type: patch
        changelog-entry: Deploy the device type logo so the UI can pick it up
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Deploy the device type logo"
      body: This is needed so that the UI can pick it up.
- version: 1.2.1
  date: 2019-06-19T12:32:53.000Z
  commits:
    - hash: 3c55b1b7ced51682138ad90ececab5b528c246ec
      author: Florin Sarbu
      footers:
        change-type: patch
        changelog-entry: Do not error if the kernel headers are not generated
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Do not error if the kernel headers are not generated"
      body: >-
        We have customers that do not want to have the kernel modules headers
        generated.

        So let's make sure the deploy won't fail when these headers are not
        present.
- version: 1.2.0
  date: 2019-05-30T15:47:27.000Z
  commits:
    - hash: 5516bf0c7c195c06763fb62f61e30c6f4cfc9512
      author: Giovanni Garufi
      footers:
        change-type: minor
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Add balena-cli to yocto-build-env docker image
      body: |-
        balena-cli will be used to push the built images as releases to a balena
        application
- version: 1.1.1
  date: 2019-05-21T05:27:46.000Z
  commits:
    - hash: 30e8d34e7b59e8d31c34bff5acd52da93a348301
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Use correct bash variable assignment"
      body: null
- version: 1.1.0
  date: 2019-05-20T15:45:21.000Z
  commits:
    - hash: eed22756cb46b0529861934ab2b54f8735c1a686
      author: Giovanni Garufi
      footers:
        change-type: minor
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Push and tag dev images to dockerhub
      body: null
- version: 1.0.6
  date: 2019-04-26T06:14:52.000Z
  commits:
    - hash: d018e3e90e041fe731be06a4221496d446e4a5ad
      author: Giovanni Garufi
      footers:
        change-type: patch
        signed-off-by: Giovanni Garufi <giovanni@balena.io>
      subject: Store rootfs manifest
      body: This file will be uploaded both as a jenkins artefact and to s3
- version: 1.0.5
  date: 2019-04-09T14:50:14.000Z
  commits:
    - hash: a4d98e61a92e3f3b5e4e30ce4148b8a3de0c8624
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Replace meta-resin reference with meta-balena"
      body: The meta-resin layer is now renamed to meta-balena
- version: 1.0.4
  date: 2019-04-09T09:27:26.000Z
  commits:
    - hash: ff8e3266e8ae2de7117258511fc8a8ec46b5fbf0
      author: Florin Sarbu
      footers:
        change-type: patch
        changelog-entry: Parse by meta-balena- instead of by meta-resin-
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "barys: Parse by meta-balena-"
      body: |-
        Now that meta-resin is renamed to meta-balena we do
        the same change here.
- version: 1.0.3
  date: 2019-03-07T14:20:24.000Z
  commits:
    - hash: d78ac5e686742d88508fbc45b926d69590340867
      author: Zubair Lutfullah Kakakhel
      footers:
        change-type: patch
        changelog-entry: Also deploy kernel source tarball
        signed-off-by: Zubair Lutfullah Kakakhel <zubair@balena.io>
      subject: "jenkins_build.sh: Deploy the kernel source tarball as well."
      body: |-
        After https://github.com/balena-os/meta-balena/pull/1328 is merged,
        the kernel_source tarball will also be created and be available.
        This will be useful if people want to compile/cross-compile external
        kernel modules. And avoids any issues that might happen with our
        reduced kernel_modules_headers tarball.
        find build/tmp/deploy/ | grep kernel_
        ./build/tmp/deploy/images/genericx86-64/kernel_modules_headers.tar.gz
        ./ build/tmp/deploy/images/genericx86-64/kernel_source.tar.gz
    - hash: 2f6b66394affd89ab8e1e1356236eabccb5c754b
      author: Florin Sarbu
      subject: Merge branch 'master' into zlk/kernel_src
      body: null
- version: 1.0.2
  date: 2019-01-18T06:39:34.000Z
  commits:
    - hash: 7eca6c9a866c7ead82b5ee7eed635ad3b233eb78
      author: Florin Sarbu
      footers:
        change-type: patch
        changelog-entry: Add error check for the in-container bash code
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: "jenkins_build.sh: Add error check for the in-container bash code"
      body: |-
        The in-container bash code can also error so we need to make sure
        we propagate this error outside the container so Jenkins fails and
        marks the build job accordingly.
- version: 1.0.1
  date: 2018-12-17T12:03:08.000Z
  commits:
    - hash: a285400f91b2678b5820731cc7b15b24a66e32ee
      author: Florin Sarbu
      footers:
        change-type: patch
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: Switch from resin-yocto-scripts to balena-yocto-scripts
      body: null
- version: 1.0.0
  date: 2018-12-14T17:14:18.000Z
  commits:
    - hash: a15c90caed5bb360175d626096f4df06e914bdb9
      author: Bruno Binet
      footers:
        signed-off-by: Florin Sarbu <florin@balena.io>
      subject: Allow to build a custom "production" resinos image
      body: We can already set the --development-image flag for barys to build a
        development image
    - hash: 588c6a784ae8f1a397070762366b1622f5663f4b
      author: Lucian Buzzo
      footers:
        change-type: major
      subject: Make 'latest' text file publicly accessible on S3
      body: null
    - hash: 50a369a252e3774362f9e24f47bdec05271c6ae4
      author: Andrei Gherzan
      footers:
        change-type: patch
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Set SUPERVISOR_TAG when using a custom supervisor tag"
      body: null
    - hash: dc5b2eedaf8dfe9fddae3b89781829710b3d39d5
      author: Lucian Buzzo
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "package.json: Update device-types package to latest version"
      body: |-
        [Issue resin-os/resinos#403]
        Improve commoninstructions for installing resinOS on a device
    - hash: 9f407b5efbd593f4312badb64dae08be302cbcc4
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Fix typo when using the deployTo variable"
      body: null
    - hash: 8e2cd0e10f25b3796911c1d3f79f52b84bd84ed5
      author: Theodor Gherzan
      footers:
        signed-off-by: Theodor Gherzan <theodor@resin.io>
      subject: When pulling resin-img use tag master
      body: null
    - hash: cb055dc0ef77fcc3a0f2b4d2838d9efb56b87956
      author: Theodor Gherzan
      footers:
        signed-off-by: Theodor Gherzan <theodor@resin.io>
      subject: Pull the latest resin-img before we run the deploy
      body: null
    - hash: be86aba25f25a27003dfaabf548447f9a29208ca
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "build/package.json: Set a valid license"
      body: |-
        This fixes a warning during builds and also makes the code license
        clearer.
    - hash: d455808f998839d073105d588f8998518428c43d
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Deploy docker artifact and push it to dockerhub for
        staging too"
      body: null
    - hash: 49d5f58ae3f9037b35c6fbc10fbfac61fa6f2d4c
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "build-device-type-json.sh: Make npm failures louder"
      body: Currently if npm fails it is difficult to debug.
    - hash: 5b4cae640649fe8f0743149921d55a1514498601
      author: Oleksiy Protas
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: Allow empty values to -a
      body: The format checker now only checks if there is an equality sign and
        something like an identifier to the left.
    - hash: 7d43cbbe597e348aca567619c971e74c60505f03
      author: Petros Angelatos
      footers:
        signed-off-by: Petros Angelatos <petrosagg@gmail.com>
      subject: support uploading resinhup archives using the new hostapp output
      body: null
    - hash: 8fb45023fbb79b03cf84844561ed224071c88a27
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "automation/jenkins_build.sh: Pull yocto-build-env"
      body: |-
        Do a docker pull on the resin/yocto-build-env image before
        starting the build. This means we always get the latest version
        of the image.
    - hash: 52615839144dd0a5327100859d29ff72934cbdb2
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "Dockerfile_yocto-build-env: Use correct ubuntu package name for ping"
      body: Package ping is a virtual package so we use the actual provider called
        iputils-ping
    - hash: e4ca4def12b3ad99de45d27716d944a836b88ad7
      author: Florin Sarbu
      subject: "jenkins_yocto-build-env.sh: Remove obsolete -f flag"
      body: The -f flag has been obsoleted since docker 1.12.x
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
    - hash: 614346c6f234259a53ff5b2b63b2b15c781dc577
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "automation/jenkins_yocto-build-env.sh: Get revision directly"
      body: |-
        Get the current short commit ID by calling git rather than
        relying on Jenkins to inject the variable.
    - hash: dae3011ae2bb0065fd70677bf6419daa0f605005
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "Dockerfile_yocto-build-env: Add some packages for Pyro"
      body: |-
        The Yocto Pyro build process is more strict about which packages
        it requires, add packages for: ip, ping, scp, ssh
    - hash: 096383f085fb505be37fec9b293cb7cd97672bb2
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Allow non-jenkins docker container builds"
      body: >-
        jenkins_build.sh should also be able to run outside of the jenkins
        environment

        and run the yocto build in a docker container.
    - hash: 25d3419c27c9ebf152b24504d0f16a618a6953a4
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "build/barys: Add --build-history flag"
      body: Allow enabling the Yocto build history feature from barys.
    - hash: 852a4de786802ac314247e7e82e24787cbf2e90d
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "build/barys: Set supervisor tag last"
      body: |-
        Set the supervisor tag value in local.conf after setting the
        default value in order to avoid the value being overwritten.
    - hash: 5314816f445d4432e355a03674248567ce01d1a7
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Add more information for dry run flag"
      body: Fix a typo too.
    - hash: 58a804bab17b7a18b7ee173000c4dd648942c382
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: pass the json file as argument to jq
      body: null
    - hash: 0603f59626973694133d3e7b27f434466347a5eb
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Also deploy non-flasher images"
      body: null
    - hash: 0adbfc6accab03aeb887d5894021f01136d2fd0d
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: pass the json file as argument to jq
      body: null
    - hash: 4d6a5c704d5dfe1837f5b10f0e4a8b20cbe23f91
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "Dockerfile_yocto-build-env: Do not include SDL"
      body: >-
        Yocto Morty can build a libsdl-native so there is no need for it in the
        docker image.

        Also we install python 2.7 as it is explicitly needed by some packages.
        E.g. xcb-proto-native
    - hash: 162d603654b26dadba4d6e5228ef485b594d9fa5
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "Dockerfile_yocto-build-env: Update docker base image to ubuntu 16.04
        (LTS)"
      body: >-
        Also update nodejs to v8 and remove npm from being installed as the
        nodejs package

        now contains the npm binary and it will conflict when "apt get
        install"-ing npm.

        We also need to install the "locales" package as it has been removed
        from the ubuntu 16.04

        base image in order to reduce the base image size.
    - hash: f32783271d86a7d9fc54c1c851de3c456c40ee37
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "Dockerfile_yocto-build-env: Add npm to yocto-build-env image"
      body: We need npm when building the yocto image for the .json generation
        routine.
    - hash: 9dd35ab50e700ef456f39723cc5e14e96d3c1eab
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_yocto-build-env.sh: Invalidate cache when building the
        yocto-build-env docker image."
      body: >-
        We specify "--no-cache" when building the yocto-build-env docker image
        to get rid of errors during "docker run" such as this one:

        Error response from daemon: could not find image: no such id:
        e34890d8e9bcb92938c0891f792b32bd83eec3ad1d50dad90eea779980e09664

        where e34890d8e9bcb92938c0891f792b32bd83eec3ad1d50dad90eea779980e09664
        does not exist on the machine doing the "docker run".
    - hash: 4cd73f4b6ecb6dad5c0c4a12ced1c7077f272a32
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Handle partial deploys"
      body: |-
        There may be cases where deployment is not fully done (network
        errors for example). In such cases, we force the redeployment.
    - hash: cc7f4d35e0fa772793a2e45c45d4df6f65666450
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Do not error out when deployment has been already
        done"
      body: >-
        Currently we call this script from Jenkins 4 times in a row: for managed
        production build,

        for managed development build, for unmanaged production build and for
        unmanaged development

        build. For various reasons related to the Jenkins environment and not
        only, one of these builds

        can fail. If the second, third or fourth of these builds fail, when
        retriggering the upstream

        Jenkins job to redo the deployment it will error out on the code
        highlighted here complaining that

        deployment is done. That should not be an error and it should only throw
        a warning and continue with

        the rest of the downstream build jobs to finish deploying successfully
        all the resin build flavours.
    - hash: 3189445fe8a3d3eb59532a2f3bca2a36a3af0856
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: 'jenkins_build.sh: Fix issues with "docker run" of resin/resin-img'
      body: >-
        We remove the "-i" arg as that throws the following error:

        "cannot enable tty mode on non tty input"

        We also add the "--rm" flag to automatically remove the container when
        it exits

        as it makes no sense for it to be running after exiting.
    - hash: 4dc4b2d917077cdd00dc5db26d531ea968020e04
      author: John (Jack) Brown
      footers:
        change-type: patch
      subject: Attempt to fix unrecognized input header error
      body: |-
        Based on the threads listed below, this should resolve the issue, which
        is related to building an image with the interactive terminal flag (-t)
        but then running it without the flag.
        https://github.com/moby/moby/pull/4882
        https://github.com/moby/moby/issues/4857
        https://github.com/moby/moby/issues/5327
    - hash: d1a6d92d0363da51f22e98c9670c916688478a98
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "generate-conf-notes.sh: Minor tweaks"
      body: |-
        Fix commands output for longer machine description.
        Replace ASCI art with ResinOS.
    - hash: f2d115c14bc1cef4042b7129cc92d7d2266483f7
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Copy to path expected by the resin image maker"
      body: null
    - hash: f3a734e1d4377e9100fb35d3054e704c6ca94bc8
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Copy just the contents of a directory"
      body: |-
        for an archived build, not the whole directory
        The image maker expects the contents of the build dir artifacts to be in
        $_deploy_dir/image/, not the entire directory with subdirectories.
    - hash: 395dc079473bbc20f25bf902448e4b3a8e7a21a2
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Copy recursively when dealing with archived build
        artifacts"
      body: >-
        Archived build artifacts flagging means we are dealing with a directory
        so we

        need to be able to copy recursively.
    - hash: d8ddd74d1aa913e7e03defdccfada474faae54a9
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Use prod as version suffix for production images"
      body: Fixes https://github.com/resin-os/resinos/issues/310
    - hash: 1f997a81691f78cbe30e716a9eec44ff7c57d3b0
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: "barys: reset, don't append, additional variables"
      body: |-
        Currently barys will append local variables to conf/local.conf each time
        it's run, leading to a long repeated list after a couple of runs.
        Clean it up before appending.
    - hash: c07573fd1cd43f60c5cb906b360b34cff93da181
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "automation/jenkins_build.sh: Add message when build has already been
        deployed"
      body: null
    - hash: 170a8f02560e65b6f3ebcf3bbab8bafa45c0452e
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "automation/jenkins_build.sh: Allow checkout of forked pull requests"
      body: >-
        When we checkout a meta-resin revision for building we must also take
        into

        consideration that such a revision might be from an external
        contributor's

        fork sent as a pull request.
    - hash: a919b62e1b718cc123338b3a287d97ae1754ad00
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "automation/jenkins_build.sh: Simplify git checkout"
      body: |-
        Remove explicit use of origin namespace when checking out
        meta-resin. If we want to specify a revision using a SHA1
        this won't work so just simply git checkout $metaResinBranch.
    - hash: c1a6bfaf1e59d94475106daf8a8ee2da6c0414bf
      author: Will Newton
      footers:
        signed-off-by: Will Newton <willn@resin.io>
      subject: "automation/jenkins_build.sh: Remove unused variables"
      body: These don't seem to be used anywhere.
    - hash: 63258fb9c65833729a7df21ff09d6ec02bcc0bfe
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Pass SSH_AUTH_SOCK to build container"
      body: |-
        We need the SSH_AUTH_SOCK variable to be passed from the host
        environment right through to the build container so that various
        processes in the docker build container can use the host's SSH keys.
    - hash: 4cec54d65f2bef3b5a51300f9704e8a6da641c5d
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: 'prepare-and-start.sh: Allow the "builder" user to access the SSH keys'
      body: >-
        We need the user "builder" in the docker build container to be able to
        use

        the host SSH keys (we need to be able to clone private git repositories
        using

        the SSH protocol for example).
    - hash: c4e2cc81c5f62525830f11de967cb29d62383890
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: resin-img generates files in the name of the current
        user"
      body: In this way we avoid any permissions errors afterwards.
    - hash: 9ac69e7a9fed12952967d9a554aab260aa2ab5d4
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Make sure IGNORE is writable"
      body: null
    - hash: 86da4bfd7157cb3aae8ca2352c756e6527e52241
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Spaces -> Tabs for consistency
      body: null
    - hash: 011607a55e3907a8016215ed315eab56cfb0877f
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Simplify "if" nesting
      body: null
    - hash: 9a8d0b248fca2a9cd94fd888b271bb9a806623bf
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Style
      body: null
    - hash: 1aa93fb09115de09ebf433aa4f53c939f9a9f8bd
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Local variables inside function style
      body: null
    - hash: 6b385e0f009366a04fae6160feb3ff9eb3dddba4
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Remove needless bashisms
      body: null
    - hash: fede157678b68f989af0b7d7f51dd461e10b7496
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Create a new function - deploy_resinhup_to_registries()
      body: null
    - hash: 6b86c636afacefb387747c5879985381ff00b8f0
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Create a new function - deploy_to_s3()
      body: null
    - hash: 083f9d708bcce37382294483a512b7f61b5bce56
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Tweak variable assignment
      body: null
    - hash: c338b2fadd01f2f1a97fd4715fc1b32cc4b5d740
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Newline
      body: null
    - hash: f50662c28c1dc0572882f92d48314b72f46cf802
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Replace script name with "$0"
      body: null
    - hash: 611538cc846208b33e13424dd152438e32c2bda3
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: Flatten one more "if"
      body: null
    - hash: 1fd76bd6bc29f1b18aee215a34e980b569a2412a
      author: Alexis Svinartchouk alexis@resin.io
      subject: IGNORE file in build folder while files are being uploaded
      body: null
    - hash: da9822b19c2ae9c523edaf5b521646322542ba13
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Use zip from compressing images"
      body: null
    - hash: ccb2dd561b3ad1d23cc7b30382da4de4346bb1fa
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Push resinhup images only for managed ones"
      body: null
    - hash: 86acb9eea2f25724dcece5b2675bfb42df9ec81e
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Always locally create latest but upload it only for
        nondev images"
      body: |-
        If latest doesn't exist the compressed partitions will not get
        generated. So make sure it always exists but only push it if we are
        deploying a non dev image.
    - hash: 2915b7847cb8fd8c4a6a70740637919863d8bedf
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: prepare.coffee depends on latest file"
      body: null
    - hash: baa2c0713a93c6a7148b79339cc06eb6cb8e10b9
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Set latest in the container"
      body: null
    - hash: 7730e8a61c8659718bb1a950975645fafbd61601
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Expect resinhup only in managed/nondev"
      body: null
    - hash: e7f2968651d82918d09c9e7b7607e782468f5e77
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Use only non development images as 'latest'"
      body: null
    - hash: 33f5a4500dc7e984e021c5eb02b7657838ee67ae
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Deploy to s3 and support build flavors"
      body: null
    - hash: 9943be3b9b883a3c6e697ac051481d272542a601
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Make sure the docker registry tags are valid"
      body: >-
        The docker registry tags need to satisfy the following regex:

        [\w][\w.-]{0,127}.

        https://github.com/docker/docker/blob/master/vendor/github.com/docker/distribution/reference/regexp.go#L37

        Make sure this is valid for our resinOS tags too.
    - hash: 8998ad66300fe71bb253c725dbc75a13f9415f2b
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Rename RESIN_SDIMG_COMPRESSION -> RESIN_RAW_IMG_COMPRESSION"
      body: Follow resinOS change.
    - hash: 20e8c450d67cd7eac5b525d75e6a79255087c0bf
      author: Andrei Gherzan
      subject: "barys.changelog: Add entry for this patch set"
      body: null
    - hash: 4680466e601301229720b98565a214b376a2302c
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: Set the locale to UTF-8 for being able
      body: >-
        to use with poky morty.

        This fixes the following poky morty error:

        Please use a locale setting which supports utf-8.

        Python can't change the filesystem locale after loading so we need a
        utf-8 when python starts or things won't work.
    - hash: 0ff791aa8555dca97add210ed4ae993f5c0ea56d
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: Add python3 to automation/Dockerfile_yocto-build-env
      body: |-
        This dependency is needed for newer builds based on poky which
        has a dependency on python3.
    - hash: f413b2a56f9950c8f5d7db66d01152797e79c4ac
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: "jenkins_build.sh: Upload production resinhup packages to
        registry.resinstaging.io"
      body: null
    - hash: 17270977d7f7f7bbf165f6cbd682aabb85a208e4
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Don't allocate a pseudo-tty when running docker
        container"
      body: >-
        Not having a tty allocated and available, yocto build will revert to
        plain text

        output.
    - hash: 6716d99fc8a138c091c9fcccd1c4f9acee75c3e9
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Implement ability to inject random variables in local.conf"
      body: null
    - hash: e75f76302bde36b086ffc2a0a7b1c2ea441e6e53
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Implement --resinio and default to resinos build configuration"
      body: null
    - hash: 83d0cfcef3e9ae58284e379af6d588d3a98107bb
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Run resinio builds with this script"
      body: null
    - hash: 09bf6b6ff289893b56051163d06033fda85747a6
      author: Theodor Gherzan
      footers:
        signed-off-by: Theodor Gherzan <theodor@gherzan.ro>
      subject: "barys: Replace DEBUG_IMAGE with DEVELOPMENT_IMAGE"
      body: null
    - hash: 966a03552bf4bedc42baf24c24cd64d1592300cb
      author: Theodor Gherzan
      footers:
        signed-off-by: Theodor Gherzan <theodor@gherzan.ro>
      subject: "jenkins_buid.sh: Replace DEBUG_IMAGE with DEVELOPMENT_IMAGE"
      body: null
    - hash: f40b910b27cea2aeebd3efc3636e842a1b798287
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: kernel_modules_headers is now filtered through gzip"
      body: null
    - hash: 518e12d279c07ffc5dda9dc4efb8cf620b84e2b8
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Upload to dockerhub resinhup packages for production
        builds"
      body: null
    - hash: 9e54267222225ca6a82847b825d450e23b7820d1
      author: Eugene Mirotin
      footers:
        signed-off-by: Eugene Mirotin <eugene@resin.io>
      subject: Use npm to install resin-device-types
      body: |-
        That removes it as a submodule dependency and allows
        automatically fetching the updated versions according to semver.
        Also install nodejs v4 and npm v3 instead of the
        much outdated versions from the standard Ubuntu repositories.
    - hash: 31724dc24cbc5618c38a3c29dab86288947d0104
      author: Florin Sarbu
      footers:
        signed-off-by: Florin Sarbu <florin@resin.io>
      subject: "jenkins_build.sh: Deploy kernel_modules_headers.tar.bz2"
      body: We need this archive exposed as a Jenkins build artifact
    - hash: 5af3cf06aa0e26846f6f657b3b555d35ef84e311
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: 'build-device-type-json.sh: discard stderr when running "which"'
      body: on some systems "which" prints to stderr if command is not found.
    - hash: a236e79711db428ed20cfc9f4317eed6c3e3e122
      author: Michal Mazurek
      footers:
        signed-off-by: Michal Mazurek <michal@resin.io>
      subject: "build-device-type-json.sh: make this work on ubuntu"
      body: |-
        Some package managers install nodejs as 'node', while others as
        'nodejs'.
        Also change the wording in the error message a little.
    - hash: f389867ad1d329b066313afb4f4e80c5e58ba73b
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Clarify invalid argument reason"
      body: null
    - hash: 0732b09f939da65e9e7b48b572d4fb0667974daf
      author: Praneeth
      footers:
        signed-off-by: Praneeth <lifeeth@gmail.com>
      subject: "jenkins_build.sh: Add a env ENABLE_TESTS - that allows for disabling
        of tests or overriding in specific cases."
      body: null
    - hash: 0a8c5f4c7ea70cf2e4a737713f74f86bc2fd3379
      author: Praneeth
      footers:
        signed-off-by: Praneeth <lifeeth@gmail.com>
      subject: "jenkins_build.sh: Add ability to run a device type specific test
        script."
      body: This script is located in the device repository at tests/start.sh
    - hash: 4ee9cc9217aec0192910d1fe8e111de9f38f4bee
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Run debug images based on env variable"
      body: null
    - hash: f13d3b751ffe994a254cdc17d5e74a97381f35fe
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: --staging was replaced by --debug-image"
      body: null
    - hash: 4b13456c5f0f1a5ee0507df49b9d76566a136e04
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Replace RESIN_STAGING_BUILD by DEBUG_IMAGE"
      body: null
    - hash: bde025432e1ec125befa86ac1f00838c772de853
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Don't default supervisor tag to production"
      body: null
    - hash: de6ca4d930af5ad0a2aa11be6b0f5320369241dc
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Use supervisor tag only if it is not ignored"
      body: null
    - hash: 02002cc986e7ebafc2dfb37fbc5dfdd78ff55df2
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "prepare-and-start.sh: First create current group and then docker"
      body: >-
        We create two groups right now: one for docker and one for the

        user running the script (to avoid any permission issues). The docker
        group

        is created without specifying the GID so it will take the first
        available one

        (in container that is 1000). The user GID can be anything from 1000 up.

        If the user has GID 1000 and we first create docker group (this will
        take 1000)

        and then the user group (1000), we will get an error. Avoid this by
        creating

        the current user group first and then the docker one.
    - hash: ab5ed5eaec59d6e585df6e0b15c2f5518c308003
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "Dockerfile: Rename to Dockerfile_yocto-build-env for clarity"
      body: null
    - hash: e6c24852dcc9d033e6a1c78c5a06d4e800a92a7c
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_yocto-build-env.sh: Add script for jenkins build"
      body: null
    - hash: fabe632b18113db9ba9c450989e5b105c1bcf0ff
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "Dockerfile: Add docker file for yocto-build-env images"
      body: null
    - hash: 6b7096bd6eb49c341eae7f096061260bd04121ad
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "prepare-and-start.sh: Add entrypoint for yocto-build-env images"
      body: |-
        This script gets all the arguments for barys, deals with all the
        prerequisites for resin yocto builds and then passes over the
        arguments while running barys.
    - hash: 4d38a45456652c9876914b8b18b9b9f0eee12223
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Run barys in yocto-build-env docker image"
      body: As well there were some minor tweaks added.
    - hash: a871e114061ff2628db4e9b3d7fee9e23ed5d07e
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "Dockerfile: Verify downloaded docker binary"
      body: null
    - hash: e711e359e554903b1826b9bb7a981934241a24d0
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "barys: Update HARD ASSUMPTIONS section"
      body: null
    - hash: 6cbe2b35bb94c111f79084c462cb96d58fc765ca
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "README.md: Add basic information"
      body: null
    - hash: da8460b9bd7eede46d93660343dd5e1f6358e784
      author: Pagan Gazzard
      subject: Compress archives into the top level dir in the tar, rather than within
        a subdir.
      body: null
    - hash: c06810b56cd29a3dac90ac3f727909b80976d962
      author: Pagan Gazzard
      subject: Always create a tar.gz for compressed artifacts, since docker only
        automatically uncompresses tar files.
      body: null
    - hash: 7c68073f1db3e7194ba2efca3010ba1413174ca0
      author: Pagan Gazzard
      subject: Use parallel compression.
      body: null
    - hash: 8574bcb71a3fdfa24312023cc5dc166f8358d2fe
      author: Andrei Gherzan
      footers:
        signed-off-by: Andrei Gherzan <andrei@resin.io>
      subject: "jenkins_build.sh: Remove build at the end"
      body: null
    - hash: 0ac899ac68a2fc952bf2389e91fb99b7f0f92c18
      author: Pagan Gazzard
      subject: "jenkins_build.sh: Add support for compressed artifacts."
      body: null
    - hash: 160a6a8f180d09c49e7349c8b85a69a3aa203ad6
      author: Pagan Gazzard
      subject: "jenkins_build.sh: Add support for compressed archive artifacts."
      body: null
    - hash: ffd74225380dcacf0c2b1d7a1641e0eed18d2c40
    - hash: 668221a907dad53ea528fb5722b5959d1b1fa7c6
    - hash: 2537a2b8adf511a272683fb267b999ba9a92dd83
    - hash: 3dbc23f64686ebf953a08823f9bd361832948169
    - hash: 6bd8e8765c6e813f231453e218242104be32ef57
    - hash: 77b4fc64c1f2de755615eb1b1e487d46f36b2d27
    - hash: 299a655dff36788f4c606815a9a3964dbe9f3734
    - hash: f7d1b4e0e6dd7986d76a213602f5583dc157c048
    - hash: b09952be6ee0f0717f874e89b125442d48c3e8c0
    - hash: 8a4a530227cbd8fefe2deeb0427d8104e65e8073
    - hash: 41d106ca5e8ff0d7fcde654ff3f4357e31cab197
    - hash: 3a44f476de52b1c24c5d6a3514b77e1849d5e5b5
    - hash: 87102706ec1477b7ba24ace9ee81504108d82986
    - hash: 8b9907bec1ce7dcc273b6be175e8cfc7aae677e9
    - hash: 7658e382fc4c1a707b210c37a7b118638df4755f
    - hash: c601b87cb8e1ee3b498cc5ce40ed211761e89cce
